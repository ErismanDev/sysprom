{% extends 'base.html' %}
{% load static %}

{% block title %}{{ titulo_pagina }}{% endblock %}

{% block content %}
<style>
    .permission-card {
        background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
        border-radius: 15px;
        box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
        border: 2px solid rgba(255, 255, 255, 0.2);
        transition: all 0.3s ease;
    }
    .permission-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(0, 123, 255, 0.4);
    }
    .permission-card.success {
        background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);
        box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
    }
    .permission-card.info {
        background: linear-gradient(135deg, #17a2b8 0%, #117a8b 100%);
        box-shadow: 0 4px 12px rgba(23, 162, 184, 0.3);
    }
    .permission-card.warning {
        background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%);
        box-shadow: 0 4px 12px rgba(255, 193, 7, 0.3);
    }
    .accordion-card {
        border: none;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        border-radius: 12px;
        margin-bottom: 12px;
        overflow: hidden;
    }
    .accordion-card .card-header {
        background: #6c757d;
        color: white;
        border: none;
        padding: 15px 20px;
        border-radius: 12px 12px 0 0;
    }
    .accordion-card .card-header button {
        color: white;
        text-decoration: none;
        font-weight: 600;
        width: 100%;
        text-align: left;
    }
    .accordion-card .card-header button:hover {
        color: rgba(255,255,255,0.9);
    }
    .accordion-card .card-header button:not(.collapsed) {
        color: white;
    }
    .section-separator {
        border-top: 3px solid #20b2aa;
        border-radius: 2px;
        position: relative;
        margin: 20px 0;
    }
    .section-separator::before {
        content: attr(data-label);
        position: absolute;
        top: -8px;
        left: 50%;
        transform: translateX(-50%);
        background: #20b2aa;
        color: white;
        padding: 2px 12px;
        border-radius: 12px;
        font-size: 10px;
        font-weight: bold;
        text-transform: uppercase;
        letter-spacing: 1px;
    }
</style>

<div class="container-fluid mt-4">
    <!-- Cabeçalho -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h3 mb-0 text-gray-800">
            <i class="fas fa-shield-alt text-primary"></i> {{ titulo_pagina }}
        </h1>
        <div class="d-flex gap-2">
            <div class="btn-group btn-group-sm" role="group">
                <button type="button" class="btn btn-outline-primary" id="expand-all-page" data-bs-toggle="tooltip" title="Expandir todos os acordeons">
                    <i class="fas fa-expand-arrows-alt"></i> Expandir Todos
                </button>
                <button type="button" class="btn btn-outline-secondary" id="collapse-all-page" data-bs-toggle="tooltip" title="Colapsar todos os acordeons">
                    <i class="fas fa-compress-arrows-alt"></i> Colapsar Todos
                </button>
            </div>
            <a href="{% url 'militares:funcoes_militares_list' %}" class="btn btn-secondary" type="button">
                <i class="fas fa-arrow-left"></i> Voltar
            </a>
        </div>
    </div>

    <!-- Estatísticas -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card permission-card text-white">
                <div class="card-body text-center">
                    <h2 class="card-title mb-2">{{ total_permissoes }}</h2>
                    <p class="card-text mb-0"><i class="fas fa-key me-2"></i>Permissões Ativas</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card permission-card success text-white">
                <div class="card-body text-center">
                    <h2 class="card-title mb-2">{{ usuarios_com_funcao }}</h2>
                    <p class="card-text mb-0"><i class="fas fa-users me-2"></i>Usuários com Função</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card permission-card info text-white">
                <div class="card-body text-center">
                    <h2 class="card-title mb-2">{{ funcao.nome|length }}</h2>
                    <p class="card-text mb-0"><i class="fas fa-font me-2"></i>Caracteres no Nome</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card permission-card warning text-white">
                <div class="card-body text-center">
                    <h2 class="card-title mb-2">100%</h2>
                    <p class="card-text mb-0"><i class="fas fa-check-circle me-2"></i>Funcional</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Formulário Principal -->
    <form method="post" id="permissions-form">
        {% csrf_token %}
        
        <!-- Permissões Granulares (Menus, Submenus e Ações) -->
        <div class="card mb-4" style="border: none; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-radius: 12px;">
            <div class="card-header" style="background: linear-gradient(135deg, #007bff, #0056b3); color: white; border-radius: 12px 12px 0 0; border: none;">
                <h5 class="mb-0">
                    <i class="fas fa-cogs me-2"></i>
                    Permissões Granulares - Estrutura do Menu Lateral
                </h5>
            </div>
            <div class="card-body">
                <div class="alert alert-info mb-0" style="border-radius: 8px;">
                    <i class="fas fa-info-circle me-2"></i>
                    Configure exatamente como aparece no menu lateral: menus principais, submenus e todos os itens de navegação
                </div>
            </div>
        </div>
                
        <!-- Acordeon Principal -->
        <div class="accordion" id="mainAccordion">
            <!-- 1. INÍCIO -->
            <div class="accordion-card">
                <div class="card-header" id="headingInicio">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInicio" aria-expanded="false" aria-controls="collapseInicio">
                                <span><i class="fas fa-home me-2"></i> Início</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm ms-2" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-inicio" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-inicio" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="collapseInicio" class="collapse" aria-labelledby="headingInicio" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="show_dashboard" id="show_dashboard" 
                                   {% if 'show_dashboard' in permissoes_dict %}checked{% endif %}>
                            <label for="show_dashboard" class="form-check-label">
                                <i class="fas fa-home me-2"></i>Página Inicial
                                <small class="text-muted d-block">Acesso à página inicial do sistema</small>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
                            
            <!-- Separador Pessoal -->
            <div class="section-separator" data-label="PESSOAL" style="margin: 30px 0;"></div>
            
            <!-- Pessoal -->
            <div class="accordion-card">
                <div class="card-header" id="headingPessoal">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePessoal" aria-expanded="false" aria-controls="collapsePessoal">
                                <span><i class="fas fa-user-circle me-2"></i> Pessoal</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm ms-2" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-pessoal" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-pessoal" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="collapsePessoal" class="collapse" aria-labelledby="headingPessoal" data-bs-parent="#mainAccordion">
                <div class="card-body">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_PESSOAL" id="MENU_PESSOAL" 
                                   {% if 'MENU_PESSOAL_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_PESSOAL" class="form-check-label">
                                Pessoal
                                <small class="text-muted d-block">Área pessoal e fichas de conceito</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_MINHAS_INFORMACOES" id="SUBMENU_MINHAS_INFORMACOES" 
                                   {% if 'SUBMENU_MINHAS_INFORMACOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_MINHAS_INFORMACOES" class="form-check-label">
                                Minhas Informações
                                <small class="text-muted d-block">Acesso às próprias informações</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_MINHA_FICHA_CADASTRO" id="SUBMENU_MINHA_FICHA_CADASTRO" 
                                   {% if 'SUBMENU_MINHA_FICHA_CADASTRO_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_MINHA_FICHA_CADASTRO" class="form-check-label">
                                Minha Ficha de Cadastro
                                <small class="text-muted d-block">Visualizar ficha de cadastro pessoal</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_MINHA_FICHA_CONCEITO_OFICIAL" id="SUBMENU_MINHA_FICHA_CONCEITO_OFICIAL" 
                                   {% if 'SUBMENU_MINHA_FICHA_CONCEITO_OFICIAL_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_MINHA_FICHA_CONCEITO_OFICIAL" class="form-check-label">
                                Minha Ficha de Conceito (Oficial)
                                <small class="text-muted d-block">Ficha de conceito para oficiais</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_MINHA_FICHA_CONCEITO_PRACA" id="SUBMENU_MINHA_FICHA_CONCEITO_PRACA" 
                                   {% if 'SUBMENU_MINHA_FICHA_CONCEITO_PRACA_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_MINHA_FICHA_CONCEITO_PRACA" class="form-check-label">
                                Minha Ficha de Conceito (Praça)
                                <small class="text-muted d-block">Ficha de conceito para praças</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_CRIAR_FICHA_CONCEITO_OFICIAL" id="SUBMENU_CRIAR_FICHA_CONCEITO_OFICIAL" 
                                   {% if 'SUBMENU_CRIAR_FICHA_CONCEITO_OFICIAL_CRIAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_CRIAR_FICHA_CONCEITO_OFICIAL" class="form-check-label">
                                Criar Ficha de Conceito (Oficial)
                                <small class="text-muted d-block">Criar fichas de conceito para oficiais</small>
                                        </label>
                                    </div>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_CRIAR_FICHA_CONCEITO_PRACA" id="SUBMENU_CRIAR_FICHA_CONCEITO_PRACA" 
                                   {% if 'SUBMENU_CRIAR_FICHA_CONCEITO_PRACA_CRIAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_CRIAR_FICHA_CONCEITO_PRACA" class="form-check-label">
                                Criar Ficha de Conceito (Praça)
                                <small class="text-muted d-block">Criar fichas de conceito para praças</small>
                                        </label>
                                    </div>
                                    </div>
                    </div>
                </div>

            <!-- Efetivo -->
            <div class="accordion-card">
                <div class="card-header" id="headingEfetivo">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseEfetivo" aria-expanded="false" aria-controls="collapseEfetivo">
                                <span><i class="fas fa-users me-2"></i> Efetivo</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm ms-2" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-efetivo" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-efetivo" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="collapseEfetivo" class="collapse" aria-labelledby="headingEfetivo" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_EFETIVO" id="MENU_EFETIVO" 
                                   {% if 'MENU_EFETIVO_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_EFETIVO" class="form-check-label">
                                Efetivo
                                <small class="text-muted d-block">Gestão do efetivo militar</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ATIVOS" id="SUBMENU_ATIVOS" 
                                   {% if 'SUBMENU_ATIVOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ATIVOS" class="form-check-label">
                                Militares Ativos
                                <small class="text-muted d-block">Gestão de militares ativos</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_INATIVOS" id="SUBMENU_INATIVOS" 
                                   {% if 'SUBMENU_INATIVOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_INATIVOS" class="form-check-label">
                                Militares Inativos
                                <small class="text-muted d-block">Gestão de militares inativos</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_LOTACOES" id="SUBMENU_LOTACOES" 
                                   {% if 'SUBMENU_LOTACOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_LOTACOES" class="form-check-label">
                                Lotações
                                <small class="text-muted d-block">Gestão de lotações</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_AVERBACOES" id="SUBMENU_AVERBACOES" 
                                   {% if 'SUBMENU_AVERBACOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_AVERBACOES" class="form-check-label">
                                <i class="fas fa-file-signature me-2"></i>Averbações
                                <small class="text-muted d-block">Gestão de averbações</small>
                            </label>
                        </div>

                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_EFETIVO_ELOGIOS" id="MENU_EFETIVO_ELOGIOS" 
                                   {% if 'MENU_EFETIVO_ELOGIOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_EFETIVO_ELOGIOS" class="form-check-label">
                                Elogios
                                <small class="text-muted d-block">Listagem de elogios do efetivo</small>
                            </label>
                        </div>

                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_EFETIVO_PUNICOES" id="MENU_EFETIVO_PUNICOES" 
                                   {% if 'MENU_EFETIVO_PUNICOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_EFETIVO_PUNICOES" class="form-check-label">
                                Punições
                                <small class="text-muted d-block">Listagem de punições do efetivo</small>
                            </label>
                        </div>
                        
                        <!-- Permissões Específicas de Militares -->
                        <div class="mt-4 pt-3 border-top">
                            <h6 class="text-primary mb-3"><i class="fas fa-cogs"></i> Permissões Específicas de Militares</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="MILITARES_VISUALIZAR" id="MILITARES_VISUALIZAR" 
                                               {% if 'MILITARES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="MILITARES_VISUALIZAR" class="form-check-label">
                                            Visualizar Militares
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="MILITARES_CRIAR" id="MILITARES_CRIAR" 
                                               {% if 'MILITARES_CRIAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="MILITARES_CRIAR" class="form-check-label">
                                            Criar Militares
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="MILITARES_EDITAR" id="MILITARES_EDITAR" 
                                               {% if 'MILITARES_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="MILITARES_EDITAR" class="form-check-label">
                                            Editar Militares
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="MILITARES_EXCLUIR" id="MILITARES_EXCLUIR" 
                                               {% if 'MILITARES_EXCLUIR' in permissoes_dict %}checked{% endif %}>
                                        <label for="MILITARES_EXCLUIR" class="form-check-label">
                                            Excluir Militares
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="MILITARES_TRANSFERIR" id="MILITARES_TRANSFERIR" 
                                               {% if 'MILITARES_TRANSFERIR' in permissoes_dict %}checked{% endif %}>
                                        <label for="MILITARES_TRANSFERIR" class="form-check-label">
                                            Transferir Militares
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="MILITARES_PROMOVER" id="MILITARES_PROMOVER" 
                                               {% if 'MILITARES_PROMOVER' in permissoes_dict %}checked{% endif %}>
                                        <label for="MILITARES_PROMOVER" class="form-check-label">
                                            Promover Militares
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="MILITARES_INATIVAR" id="MILITARES_INATIVAR" 
                                               {% if 'MILITARES_INATIVAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="MILITARES_INATIVAR" class="form-check-label">
                                            Inativar Militares
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="MILITARES_FICHA_CONCEITO" id="MILITARES_FICHA_CONCEITO" 
                                               {% if 'MILITARES_FICHA_CONCEITO' in permissoes_dict %}checked{% endif %}>
                                        <label for="MILITARES_FICHA_CONCEITO" class="form-check-label">
                                            Ficha de Conceito
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Botões de Lotação -->
                        <div class="mt-4 pt-3 border-top">
                            <h6 class="text-primary mb-3"><i class="fas fa-building"></i> Botões de Lotação</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="BOTAO_LOTACAO_NOVA" id="BOTAO_LOTACAO_NOVA" 
                                               {% if 'BOTAO_LOTACAO_NOVA' in permissoes_dict %}checked{% endif %}>
                                        <label for="BOTAO_LOTACAO_NOVA" class="form-check-label">
                                            <i class="fas fa-plus me-1"></i>Mostrar Botão "Nova Lotação"
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="BOTAO_LOTACAO_EDITAR" id="BOTAO_LOTACAO_EDITAR" 
                                               {% if 'BOTAO_LOTACAO_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="BOTAO_LOTACAO_EDITAR" class="form-check-label">
                                            <i class="fas fa-edit me-1"></i>Mostrar Botão "Editar Lotação"
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="BOTAO_LOTACAO_EXCLUIR" id="BOTAO_LOTACAO_EXCLUIR" 
                                               {% if 'BOTAO_LOTACAO_EXCLUIR' in permissoes_dict %}checked{% endif %}>
                                        <label for="BOTAO_LOTACAO_EXCLUIR" class="form-check-label">
                                            <i class="fas fa-trash me-1"></i>Mostrar Botão "Excluir Lotação"
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="BOTAO_LOTACAO_ESTATISTICAS" id="BOTAO_LOTACAO_ESTATISTICAS" 
                                               {% if 'BOTAO_LOTACAO_ESTATISTICAS' in permissoes_dict %}checked{% endif %}>
                                        <label for="BOTAO_LOTACAO_ESTATISTICAS" class="form-check-label">
                                            <i class="fas fa-chart-bar me-1"></i>Mostrar Botão "Estatísticas"
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Elogios -->
            <div class="accordion-card">
                <div class="card-header" id="headingElogios">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseElogios" aria-expanded="false" aria-controls="collapseElogios">
                                <span><i class="fas fa-trophy me-2"></i> Elogios</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-elogios" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-elogios" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="collapseElogios" class="collapse" aria-labelledby="headingElogios" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_ELOGIOS" id="MENU_ELOGIOS" 
                                   {% if 'MENU_ELOGIOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_ELOGIOS" class="form-check-label">
                                Elogios
                                <small class="text-muted d-block">Menu principal de elogios</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ELOGIOS_OFICIAIS" id="SUBMENU_ELOGIOS_OFICIAIS" 
                                   {% if 'SUBMENU_ELOGIOS_OFICIAIS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ELOGIOS_OFICIAIS" class="form-check-label">
                                Oficiais
                                <small class="text-muted d-block">Listagem de elogios de oficiais</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ELOGIOS_PRACAS" id="SUBMENU_ELOGIOS_PRACAS" 
                                   {% if 'SUBMENU_ELOGIOS_PRACAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ELOGIOS_PRACAS" class="form-check-label">
                                Praças
                                <small class="text-muted d-block">Listagem de elogios de praças</small>
                            </label>
                        </div>

                        <div class="mt-3">
                            <h6 class="text-secondary">Permissões de Ação (Elogios)</h6>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="elogios_visualizar" id="elogios_visualizar"
                                               {% if 'ELOGIOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="elogios_visualizar" class="form-check-label">Visualizar</label>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="elogios_criar" id="elogios_criar"
                                               {% if 'ELOGIOS_CRIAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="elogios_criar" class="form-check-label">Criar</label>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="elogios_editar" id="elogios_editar"
                                               {% if 'ELOGIOS_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="elogios_editar" class="form-check-label">Editar</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Punições -->
            <div class="accordion-card">
                <div class="card-header" id="headingPunicoes">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePunicoes" aria-expanded="false" aria-controls="collapsePunicoes">
                                <span><i class="fas fa-gavel text-danger"></i> Punições</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-punicoes" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-punicoes" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="collapsePunicoes" class="collapse" aria-labelledby="headingPunicoes" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_PUNICOES" id="MENU_PUNICOES" 
                                   {% if 'MENU_PUNICOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_PUNICOES" class="form-check-label">
                                Punições
                                <small class="text-muted d-block">Menu principal de punições</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_PUNICOES_OFICIAIS" id="SUBMENU_PUNICOES_OFICIAIS" 
                                   {% if 'SUBMENU_PUNICOES_OFICIAIS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_PUNICOES_OFICIAIS" class="form-check-label">
                                Oficiais
                                <small class="text-muted d-block">Listagem de punições de oficiais</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_PUNICOES_PRACAS" id="SUBMENU_PUNICOES_PRACAS" 
                                   {% if 'SUBMENU_PUNICOES_PRACAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_PUNICOES_PRACAS" class="form-check-label">
                                Praças
                                <small class="text-muted d-block">Listagem de punições de praças</small>
                            </label>
                        </div>

                        <div class="mt-3">
                            <h6 class="text-secondary">Permissões de Ação (Punições)</h6>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="punicoes_visualizar" id="punicoes_visualizar"
                                               {% if 'PUNICOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="punicoes_visualizar" class="form-check-label">Visualizar</label>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="punicoes_criar" id="punicoes_criar"
                                               {% if 'PUNICOES_CRIAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="punicoes_criar" class="form-check-label">Criar</label>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="punicoes_editar" id="punicoes_editar"
                                               {% if 'PUNICOES_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="punicoes_editar" class="form-check-label">Editar</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ensino -->
            <div class="accordion-card">
                <div class="card-header" id="headingEnsino">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseEnsino" aria-expanded="false" aria-controls="collapseEnsino">
                                <span><i class="fas fa-graduation-cap text-info"></i> Ensino</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-ensino" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-ensino" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="collapseEnsino" class="collapse" aria-labelledby="headingEnsino" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_ENSINO" id="MENU_ENSINO" 
                                   {% if 'MENU_ENSINO_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_ENSINO" class="form-check-label">
                                Ensino
                                <small class="text-muted d-block">Menu principal de ensino</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ENSINO_DASHBOARD" id="SUBMENU_ENSINO_DASHBOARD" 
                                   {% if 'SUBMENU_ENSINO_DASHBOARD_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ENSINO_DASHBOARD" class="form-check-label">
                                Dashboard de Ensino
                                <small class="text-muted d-block">Painel principal com indicadores do ensino</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ENSINO_CURSOS" id="SUBMENU_ENSINO_CURSOS" 
                                   {% if 'SUBMENU_ENSINO_CURSOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ENSINO_CURSOS" class="form-check-label">
                                Cursos
                                <small class="text-muted d-block">Gerenciamento de cursos</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ENSINO_TURMAS" id="SUBMENU_ENSINO_TURMAS" 
                                   {% if 'SUBMENU_ENSINO_TURMAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ENSINO_TURMAS" class="form-check-label">
                                Turmas
                                <small class="text-muted d-block">Gerenciamento de turmas</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ENSINO_DISCIPLINAS" id="SUBMENU_ENSINO_DISCIPLINAS" 
                                   {% if 'SUBMENU_ENSINO_DISCIPLINAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ENSINO_DISCIPLINAS" class="form-check-label">
                                Disciplinas
                                <small class="text-muted d-block">Gerenciamento de disciplinas</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ENSINO_ALUNOS" id="SUBMENU_ENSINO_ALUNOS" 
                                   {% if 'SUBMENU_ENSINO_ALUNOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ENSINO_ALUNOS" class="form-check-label">
                                Alunos
                                <small class="text-muted d-block">Gerenciamento de alunos</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ENSINO_INSTRUTORES" id="SUBMENU_ENSINO_INSTRUTORES" 
                                   {% if 'SUBMENU_ENSINO_INSTRUTORES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ENSINO_INSTRUTORES" class="form-check-label">
                                Instrutores
                                <small class="text-muted d-block">Gerenciamento de instrutores</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ENSINO_MONITORES" id="SUBMENU_ENSINO_MONITORES" 
                                   {% if 'SUBMENU_ENSINO_MONITORES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ENSINO_MONITORES" class="form-check-label">
                                Monitores
                                <small class="text-muted d-block">Gerenciamento de monitores</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ENSINO_AULAS" id="SUBMENU_ENSINO_AULAS" 
                                   {% if 'SUBMENU_ENSINO_AULAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ENSINO_AULAS" class="form-check-label">
                                Aulas
                                <small class="text-muted d-block">Gerenciamento de aulas</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ENSINO_FREQUENCIAS" id="SUBMENU_ENSINO_FREQUENCIAS" 
                                   {% if 'SUBMENU_ENSINO_FREQUENCIAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ENSINO_FREQUENCIAS" class="form-check-label">
                                Frequências
                                <small class="text-muted d-block">Controle de frequência dos alunos</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ENSINO_AVALIACOES" id="SUBMENU_ENSINO_AVALIACOES" 
                                   {% if 'SUBMENU_ENSINO_AVALIACOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ENSINO_AVALIACOES" class="form-check-label">
                                Avaliações
                                <small class="text-muted d-block">Gerenciamento de avaliações e notas</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ENSINO_CERTIFICADOS" id="SUBMENU_ENSINO_CERTIFICADOS" 
                                   {% if 'SUBMENU_ENSINO_CERTIFICADOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ENSINO_CERTIFICADOS" class="form-check-label">
                                Certificados
                                <small class="text-muted d-block">Gerenciamento de certificados</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ENSINO_QUADROS_TRABALHO_SEMANAL" id="SUBMENU_ENSINO_QUADROS_TRABALHO_SEMANAL" 
                                   {% if 'SUBMENU_ENSINO_QUADROS_TRABALHO_SEMANAL_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ENSINO_QUADROS_TRABALHO_SEMANAL" class="form-check-label">
                                Quadros de Trabalho Semanal
                                <small class="text-muted d-block">Gerenciamento de quadros de trabalho semanal</small>
                            </label>
                        </div>

                        <div class="mt-3">
                            <h6 class="text-secondary">Permissões de Ação (Ensino)</h6>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="ensino_visualizar" id="ensino_visualizar"
                                               {% if 'ENSINO_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="ensino_visualizar" class="form-check-label">Visualizar</label>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="ensino_criar" id="ensino_criar"
                                               {% if 'ENSINO_CRIAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="ensino_criar" class="form-check-label">Criar</label>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="ensino_editar" id="ensino_editar"
                                               {% if 'ENSINO_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="ensino_editar" class="form-check-label">Editar</label>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="ensino_excluir" id="ensino_excluir"
                                               {% if 'ENSINO_EXCLUIR' in permissoes_dict %}checked{% endif %}>
                                        <label for="ensino_excluir" class="form-check-label">Excluir</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
                        
            <!-- Seção de Promoções -->
            <div class="accordion-card">
                <div class="card-header" id="headingPromocoes">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePromocoes" aria-expanded="false" aria-controls="collapsePromocoes">
                                <span><i class="fas fa-star text-warning"></i> Seção de Promoções</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-promocoes" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-promocoes" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="collapsePromocoes" class="collapse" aria-labelledby="headingPromocoes" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_SECAO_PROMOCOES" id="MENU_SECAO_PROMOCOES" 
                                   {% if 'MENU_SECAO_PROMOCOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_SECAO_PROMOCOES" class="form-check-label">
                                Seção de Promoções
                                <small class="text-muted d-block">Gestão de promoções e quadros</small>
                                    </label>
                                </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_FICHAS_OFICIAIS" id="SUBMENU_FICHAS_OFICIAIS" 
                                   {% if 'SUBMENU_FICHAS_OFICIAIS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_FICHAS_OFICIAIS" class="form-check-label">
                                Fichas de Oficiais
                                <small class="text-muted d-block">Gestão de fichas de oficiais</small>
                            </label>
                            </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_FICHAS_PRACAS" id="SUBMENU_FICHAS_PRACAS" 
                                   {% if 'SUBMENU_FICHAS_PRACAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_FICHAS_PRACAS" class="form-check-label">
                                Fichas de Praças
                                <small class="text-muted d-block">Gestão de fichas de praças</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_QUADROS_ACESSO" id="SUBMENU_QUADROS_ACESSO" 
                                   {% if 'SUBMENU_QUADROS_ACESSO_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_QUADROS_ACESSO" class="form-check-label">
                                Quadros de Acesso
                                <small class="text-muted d-block">Gestão de quadros de acesso</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_QUADROS_FIXACAO" id="SUBMENU_QUADROS_FIXACAO" 
                                   {% if 'SUBMENU_QUADROS_FIXACAO_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_QUADROS_FIXACAO" class="form-check-label">
                                Quadros de Fixação
                                <small class="text-muted d-block">Gestão de quadros de fixação</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ALMANAQUES" id="SUBMENU_ALMANAQUES" 
                                   {% if 'SUBMENU_ALMANAQUES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ALMANAQUES" class="form-check-label">
                                Almanaques
                                <small class="text-muted d-block">Gestão de almanaques</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_PROMOCOES" id="SUBMENU_PROMOCOES" 
                                   {% if 'SUBMENU_PROMOCOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_PROMOCOES" class="form-check-label">
                                Promoções
                                <small class="text-muted d-block">Gestão de promoções</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_CALENDARIOS" id="SUBMENU_CALENDARIOS" 
                                   {% if 'SUBMENU_CALENDARIOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_CALENDARIOS" class="form-check-label">
                                Calendários
                                <small class="text-muted d-block">Gestão de calendários</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_COMISSOES" id="SUBMENU_COMISSOES" 
                                   {% if 'SUBMENU_COMISSOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_COMISSOES" class="form-check-label">
                                Comissões
                                <small class="text-muted d-block">Gestão de comissões</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_MEUS_VOTOS" id="SUBMENU_MEUS_VOTOS" 
                                   {% if 'SUBMENU_MEUS_VOTOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_MEUS_VOTOS" class="form-check-label">
                                Meus Votos
                                <small class="text-muted d-block">Visualizar meus votos</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_INTERSTICIOS" id="SUBMENU_INTERSTICIOS" 
                                   {% if 'SUBMENU_INTERSTICIOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_INTERSTICIOS" class="form-check-label">
                                Interstícios
                                <small class="text-muted d-block">Gestão de interstícios</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_GERENCIAR_INTERSTICIOS" id="SUBMENU_GERENCIAR_INTERSTICIOS" 
                                   {% if 'SUBMENU_GERENCIAR_INTERSTICIOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_GERENCIAR_INTERSTICIOS" class="form-check-label">
                                Gerenciar Interstícios
                                <small class="text-muted d-block">Gerenciar interstícios</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_GERENCIAR_PREVISAO" id="SUBMENU_GERENCIAR_PREVISAO" 
                                   {% if 'SUBMENU_GERENCIAR_PREVISAO_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_GERENCIAR_PREVISAO" class="form-check-label">
                                Gerenciar Previsão
                                <small class="text-muted d-block">Gerenciar previsões</small>
                            </label>
                        </div>
                        
                        <!-- Permissões Específicas de Quadros de Acesso -->
                        <div class="mt-4 pt-3 border-top">
                            <h6 class="text-warning mb-3"><i class="fas fa-cogs"></i> Permissões Específicas de Quadros de Acesso</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="QUADROS_ACESSO_VISUALIZAR" id="QUADROS_ACESSO_VISUALIZAR" 
                                               {% if 'QUADROS_ACESSO_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="QUADROS_ACESSO_VISUALIZAR" class="form-check-label">
                                            Visualizar Quadros
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="QUADROS_ACESSO_CRIAR" id="QUADROS_ACESSO_CRIAR" 
                                               {% if 'QUADROS_ACESSO_CRIAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="QUADROS_ACESSO_CRIAR" class="form-check-label">
                                            Criar Quadros
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="QUADROS_ACESSO_EDITAR" id="QUADROS_ACESSO_EDITAR" 
                                               {% if 'QUADROS_ACESSO_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="QUADROS_ACESSO_EDITAR" class="form-check-label">
                                            Editar Quadros
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="QUADROS_ACESSO_GERAR_PDF" id="QUADROS_ACESSO_GERAR_PDF" 
                                               {% if 'QUADROS_ACESSO_GERAR_PDF' in permissoes_dict %}checked{% endif %}>
                                        <label for="QUADROS_ACESSO_GERAR_PDF" class="form-check-label">
                                            Gerar PDF dos Quadros
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="QUADROS_ACESSO_HOMOLOGAR" id="QUADROS_ACESSO_HOMOLOGAR" 
                                               {% if 'QUADROS_ACESSO_HOMOLOGAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="QUADROS_ACESSO_HOMOLOGAR" class="form-check-label">
                                            Homologar Quadros
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="QUADROS_ACESSO_ELABORAR" id="QUADROS_ACESSO_ELABORAR" 
                                               {% if 'QUADROS_ACESSO_ELABORAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="QUADROS_ACESSO_ELABORAR" class="form-check-label">
                                            Elaborar Quadros
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
                        
            <!-- Medalhas -->
            <div class="accordion-card">
                <div class="card-header" id="headingMedalhas">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseMedalhas" aria-expanded="false" aria-controls="collapseMedalhas">
                                <span><i class="fas fa-medal text-warning"></i> Medalhas</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-medalhas" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-medalhas" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                            </div>
                <div id="collapseMedalhas" class="collapse" aria-labelledby="headingMedalhas" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_MEDALHAS" id="MENU_MEDALHAS" 
                                   {% if 'MENU_MEDALHAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_MEDALHAS" class="form-check-label">
                                Medalhas
                                <small class="text-muted d-block">Gestão de medalhas e condecorações</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_MEDALHAS_CONCESSOES" id="SUBMENU_MEDALHAS_CONCESSOES" 
                                   {% if 'SUBMENU_MEDALHAS_CONCESSOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_MEDALHAS_CONCESSOES" class="form-check-label">
                                Concessões de Medalhas
                                <small class="text-muted d-block">Gestão de concessões</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_MEDALHAS_PROPOSTAS" id="SUBMENU_MEDALHAS_PROPOSTAS" 
                                   {% if 'SUBMENU_MEDALHAS_PROPOSTAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_MEDALHAS_PROPOSTAS" class="form-check-label">
                                Propostas de Medalhas
                                <small class="text-muted d-block">Gestão de propostas</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ELEGIVEIS" id="SUBMENU_ELEGIVEIS" 
                                   {% if 'SUBMENU_ELEGIVEIS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ELEGIVEIS" class="form-check-label">
                                Elegíveis
                                <small class="text-muted d-block">Lista de elegíveis</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_PROPOSTAS" id="SUBMENU_PROPOSTAS" 
                                   {% if 'SUBMENU_PROPOSTAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_PROPOSTAS" class="form-check-label">
                                Propostas
                                <small class="text-muted d-block">Gestão de propostas</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_CONCEDER_MEDALHA" id="SUBMENU_CONCEDER_MEDALHA" 
                                   {% if 'SUBMENU_CONCEDER_MEDALHA_CRIAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_CONCEDER_MEDALHA" class="form-check-label">
                                Conceder Medalha
                                <small class="text-muted d-block">Conceder medalhas</small>
                            </label>
                        </div>
                        
                        <!-- Permissões Específicas de Medalhas -->
                        <div class="mt-4 pt-3 border-top">
                            <h6 class="text-warning mb-3"><i class="fas fa-cogs"></i> Permissões Específicas de Medalhas</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="MEDALHAS_VISUALIZAR" id="MEDALHAS_VISUALIZAR" 
                                               {% if 'MEDALHAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="MEDALHAS_VISUALIZAR" class="form-check-label">
                                            Visualizar Medalhas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="MEDALHAS_CRIAR" id="MEDALHAS_CRIAR" 
                                               {% if 'MEDALHAS_CRIAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="MEDALHAS_CRIAR" class="form-check-label">
                                            Criar Medalhas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="MEDALHAS_APROVAR" id="MEDALHAS_APROVAR" 
                                               {% if 'MEDALHAS_APROVAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="MEDALHAS_APROVAR" class="form-check-label">
                                            Aprovar Medalhas
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="MEDALHAS_HOMOLOGAR" id="MEDALHAS_HOMOLOGAR" 
                                               {% if 'MEDALHAS_HOMOLOGAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="MEDALHAS_HOMOLOGAR" class="form-check-label">
                                            Homologar Medalhas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="MEDALHAS_CONCEDER" id="MEDALHAS_CONCEDER" 
                                               {% if 'MEDALHAS_CONCEDER' in permissoes_dict %}checked{% endif %}>
                                        <label for="MEDALHAS_CONCEDER" class="form-check-label">
                                            Conceder Medalhas
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
                        
            <!-- Publicações -->
            <div class="accordion-card">
                <div class="card-header" id="headingPublicacoes">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePublicacoes" aria-expanded="false" aria-controls="collapsePublicacoes">
                                <span><i class="fas fa-newspaper text-info"></i> Publicações</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-publicacoes" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-publicacoes" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                            </div>
                <div id="collapsePublicacoes" class="collapse" aria-labelledby="headingPublicacoes" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_PUBLICACOES" id="MENU_PUBLICACOES" 
                                   {% if 'MENU_PUBLICACOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_PUBLICACOES" class="form-check-label">
                                Publicações
                                <small class="text-muted d-block">Gestão de publicações e documentos</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_NOTAS" id="SUBMENU_NOTAS" 
                                   {% if 'SUBMENU_NOTAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_NOTAS" class="form-check-label">
                                Notas
                                <small class="text-muted d-block">Gestão de notas</small>
                            </label>
                                </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_BOLETINS_OSTENSIVOS" id="SUBMENU_BOLETINS_OSTENSIVOS" 
                                   {% if 'SUBMENU_BOLETINS_OSTENSIVOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_BOLETINS_OSTENSIVOS" class="form-check-label">
                                Boletins Ostensivos
                                <small class="text-muted d-block">Gestão de boletins ostensivos</small>
                            </label>
                            </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_BOLETINS_RESERVADOS" id="SUBMENU_BOLETINS_RESERVADOS" 
                                   {% if 'SUBMENU_BOLETINS_RESERVADOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_BOLETINS_RESERVADOS" class="form-check-label">
                                Boletins Reservados
                                <small class="text-muted d-block">Gestão de boletins reservados</small>
                            </label>
                            </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_BOLETINS_ESPECIAIS" id="SUBMENU_BOLETINS_ESPECIAIS" 
                                   {% if 'SUBMENU_BOLETINS_ESPECIAIS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_BOLETINS_ESPECIAIS" class="form-check-label">
                                Boletins Especiais
                                <small class="text-muted d-block">Gestão de boletins especiais</small>
                                    </label>
                        </div>
                        
                        <!-- Permissões Específicas de Publicações -->
                        <div class="mt-4 pt-3 border-top">
                            <h6 class="text-info mb-3"><i class="fas fa-cogs"></i> Permissões Específicas de Publicações</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <h6 class="text-secondary mb-2"><small>Notas</small></h6>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="NOTAS_VISUALIZAR" id="NOTAS_VISUALIZAR" 
                                               {% if 'NOTAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="NOTAS_VISUALIZAR" class="form-check-label">
                                            Visualizar Notas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="NOTAS_CRIAR" id="NOTAS_CRIAR" 
                                               {% if 'NOTAS_CRIAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="NOTAS_CRIAR" class="form-check-label">
                                            Criar Notas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="NOTAS_EDITAR" id="NOTAS_EDITAR" 
                                               {% if 'NOTAS_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="NOTAS_EDITAR" class="form-check-label">
                                            Editar Notas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="NOTAS_PUBLICAR" id="NOTAS_PUBLICAR" 
                                               {% if 'NOTAS_PUBLICAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="NOTAS_PUBLICAR" class="form-check-label">
                                            Publicar Notas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="NOTAS_APROVAR" id="NOTAS_APROVAR" 
                                               {% if 'NOTAS_APROVAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="NOTAS_APROVAR" class="form-check-label">
                                            Aprovar Notas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="NOTAS_REVISAR" id="NOTAS_REVISAR" 
                                               {% if 'NOTAS_REVISAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="NOTAS_REVISAR" class="form-check-label">
                                            Revisar Notas
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <h6 class="text-secondary mb-2"><small>Boletins Ostensivos</small></h6>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="BOLETINS_OSTENSIVOS_VISUALIZAR" id="BOLETINS_OSTENSIVOS_VISUALIZAR" 
                                               {% if 'BOLETINS_OSTENSIVOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="BOLETINS_OSTENSIVOS_VISUALIZAR" class="form-check-label">
                                            Visualizar Boletins Ostensivos
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="BOLETINS_OSTENSIVOS_CRIAR" id="BOLETINS_OSTENSIVOS_CRIAR" 
                                               {% if 'BOLETINS_OSTENSIVOS_CRIAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="BOLETINS_OSTENSIVOS_CRIAR" class="form-check-label">
                                            Criar Boletins Ostensivos
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="BOLETINS_OSTENSIVOS_APROVAR" id="BOLETINS_OSTENSIVOS_APROVAR" 
                                               {% if 'BOLETINS_OSTENSIVOS_APROVAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="BOLETINS_OSTENSIVOS_APROVAR" class="form-check-label">
                                            Aprovar Boletins Ostensivos
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Botões de Publicação -->
                        <div class="mt-4 pt-3 border-top">
                            <h6 class="text-info mb-3"><i class="fas fa-newspaper"></i> Botões de Publicação</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="BOTAO_PUBLICACAO_NOVA" id="BOTAO_PUBLICACAO_NOVA" 
                                               {% if 'BOTAO_PUBLICACAO_NOVA' in permissoes_dict %}checked{% endif %}>
                                        <label for="BOTAO_PUBLICACAO_NOVA" class="form-check-label">
                                            <i class="fas fa-plus me-1"></i>Mostrar Botão "Nova Publicação"
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="BOTAO_PUBLICACAO_EDITAR" id="BOTAO_PUBLICACAO_EDITAR" 
                                               {% if 'BOTAO_PUBLICACAO_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="BOTAO_PUBLICACAO_EDITAR" class="form-check-label">
                                            <i class="fas fa-edit me-1"></i>Mostrar Botão "Editar Publicação"
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="BOTAO_PUBLICACAO_PUBLICAR" id="BOTAO_PUBLICACAO_PUBLICAR" 
                                               {% if 'BOTAO_PUBLICACAO_PUBLICAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="BOTAO_PUBLICACAO_PUBLICAR" class="form-check-label">
                                            <i class="fas fa-globe me-1"></i>Mostrar Botão "Publicar"
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="BOTAO_PUBLICACAO_ASSINAR" id="BOTAO_PUBLICACAO_ASSINAR" 
                                               {% if 'BOTAO_PUBLICACAO_ASSINAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="BOTAO_PUBLICACAO_ASSINAR" class="form-check-label">
                                            <i class="fas fa-signature me-1"></i>Mostrar Botão "Assinar"
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Escalas de Serviço -->
            <div class="accordion-card">
                <div class="card-header" id="headingEscalas">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseEscalas" aria-expanded="false" aria-controls="collapseEscalas">
                                <span><i class="fas fa-calendar-alt text-primary"></i> Escalas de Serviço</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-escalas" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-escalas" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="collapseEscalas" class="collapse" aria-labelledby="headingEscalas" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_ESCALAS" id="MENU_ESCALAS" 
                                   {% if 'MENU_ESCALAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_ESCALAS" class="form-check-label">
                                Escalas de Serviço
                                <small class="text-muted d-block">Gestão de escalas de serviço</small>
                                    </label>
                                </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ESCALAS_DASHBOARD" id="SUBMENU_ESCALAS_DASHBOARD" 
                                   {% if 'SUBMENU_ESCALAS_DASHBOARD_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ESCALAS_DASHBOARD" class="form-check-label">
                                Dashboard de Escalas
                                <small class="text-muted d-block">Painel de escalas</small>
                                    </label>
                                </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ESCALAS_LISTA" id="SUBMENU_ESCALAS_LISTA" 
                                   {% if 'SUBMENU_ESCALAS_LISTA_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ESCALAS_LISTA" class="form-check-label">
                                Lista de Escalas
                                <small class="text-muted d-block">Lista de escalas</small>
                                    </label>
                                </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ESCALAS_CONFIGURACAO" id="SUBMENU_ESCALAS_CONFIGURACAO" 
                                   {% if 'SUBMENU_ESCALAS_CONFIGURACAO_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ESCALAS_CONFIGURACAO" class="form-check-label">
                                Configuração de Escalas
                                <small class="text-muted d-block">Configurar escalas</small>
                                    </label>
                                </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ESCALAS_BANCO_HORAS" id="SUBMENU_ESCALAS_BANCO_HORAS" 
                                   {% if 'SUBMENU_ESCALAS_BANCO_HORAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ESCALAS_BANCO_HORAS" class="form-check-label">
                                Banco de Horas
                                <small class="text-muted d-block">Gestão de banco de horas</small>
                                    </label>
                                </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ESCALAS_OPERACOES" id="SUBMENU_ESCALAS_OPERACOES" 
                                   {% if 'SUBMENU_ESCALAS_OPERACOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ESCALAS_OPERACOES" class="form-check-label">
                                Operações de Escalas
                                <small class="text-muted d-block">Operações de escalas</small>
                            </label>
                        </div>
                        
                        <!-- Permissões Específicas de Escalas -->
                        <div class="mt-4 pt-3 border-top">
                            <h6 class="text-primary mb-3"><i class="fas fa-cogs"></i> Permissões Específicas de Escalas</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="ESCALAS_VISUALIZAR" id="ESCALAS_VISUALIZAR" 
                                               {% if 'ESCALAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="ESCALAS_VISUALIZAR" class="form-check-label">
                                            Visualizar Escalas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="ESCALAS_CRIAR" id="ESCALAS_CRIAR" 
                                               {% if 'ESCALAS_CRIAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="ESCALAS_CRIAR" class="form-check-label">
                                            Criar Escalas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="ESCALAS_EDITAR" id="ESCALAS_EDITAR" 
                                               {% if 'ESCALAS_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="ESCALAS_EDITAR" class="form-check-label">
                                            Editar Escalas
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="ESCALAS_GERAR_PDF" id="ESCALAS_GERAR_PDF" 
                                               {% if 'ESCALAS_GERAR_PDF' in permissoes_dict %}checked{% endif %}>
                                        <label for="ESCALAS_GERAR_PDF" class="form-check-label">
                                            Gerar PDF das Escalas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="ESCALAS_ADICIONAR_MILITAR" id="ESCALAS_ADICIONAR_MILITAR" 
                                               {% if 'ESCALAS_ADICIONAR_MILITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="ESCALAS_ADICIONAR_MILITAR" class="form-check-label">
                                            Adicionar Militar à Escala
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="ESCALAS_CONFIGURAR_HORAS" id="ESCALAS_CONFIGURAR_HORAS" 
                                               {% if 'ESCALAS_CONFIGURAR_HORAS' in permissoes_dict %}checked{% endif %}>
                                        <label for="ESCALAS_CONFIGURAR_HORAS" class="form-check-label">
                                            Configurar Horas
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Configurações/Sistema -->
            <div class="accordion-card">
                <div class="card-header" id="headingConfiguracoes">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseConfiguracoes" aria-expanded="false" aria-controls="collapseConfiguracoes">
                                <span><i class="fas fa-cogs text-secondary"></i> Configurações/Sistema</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-configuracoes" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-configuracoes" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="collapseConfiguracoes" class="collapse" aria-labelledby="headingConfiguracoes" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_CONFIGURACOES" id="MENU_CONFIGURACOES" 
                                   {% if 'MENU_CONFIGURACOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_CONFIGURACOES" class="form-check-label">
                                Configurações/Sistema
                                <small class="text-muted d-block">Configurações do sistema</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_USUARIOS" id="SUBMENU_USUARIOS" 
                                   {% if 'SUBMENU_USUARIOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_USUARIOS" class="form-check-label">
                                Usuários
                                <small class="text-muted d-block">Gestão de usuários</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_PERMISSOES" id="SUBMENU_PERMISSOES" 
                                   {% if 'SUBMENU_PERMISSOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_PERMISSOES" class="form-check-label">
                                Permissões
                                <small class="text-muted d-block">Gestão de permissões</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ORGAOS" id="SUBMENU_ORGAOS" 
                                   {% if 'SUBMENU_ORGAOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ORGAOS" class="form-check-label">
                                Órgãos
                                <small class="text-muted d-block">Gestão de órgãos</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ORGANOGRAMA" id="SUBMENU_ORGANOGRAMA" 
                                   {% if 'SUBMENU_ORGANOGRAMA_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ORGANOGRAMA" class="form-check-label">
                                Organograma
                                <small class="text-muted d-block">Gestão do organograma</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_LOGS" id="SUBMENU_LOGS" 
                                   {% if 'SUBMENU_LOGS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_LOGS" class="form-check-label">
                                Logs do Sistema
                                <small class="text-muted d-block">Visualizar logs do sistema</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_TITULOS_PUBLICACAO" id="SUBMENU_TITULOS_PUBLICACAO" 
                                   {% if 'SUBMENU_TITULOS_PUBLICACAO_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_TITULOS_PUBLICACAO" class="form-check-label">
                                Títulos de Publicação
                                <small class="text-muted d-block">Gestão de títulos</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ADMINISTRACAO" id="SUBMENU_ADMINISTRACAO" 
                                   {% if 'SUBMENU_ADMINISTRACAO_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ADMINISTRACAO" class="form-check-label">
                                Administração
                                <small class="text-muted d-block">Área administrativa</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_GRANDES_COMANDOS" id="SUBMENU_GRANDES_COMANDOS" 
                                   {% if 'SUBMENU_GRANDES_COMANDOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_GRANDES_COMANDOS" class="form-check-label">
                                Grandes Comandos
                                <small class="text-muted d-block">Gestão de grandes comandos</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_UNIDADES" id="SUBMENU_UNIDADES" 
                                   {% if 'SUBMENU_UNIDADES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_UNIDADES" class="form-check-label">
                                Unidades
                                <small class="text-muted d-block">Gestão de unidades</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_SUB_UNIDADES" id="SUBMENU_SUB_UNIDADES" 
                                   {% if 'SUBMENU_SUB_UNIDADES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_SUB_UNIDADES" class="form-check-label">
                                Sub-Unidades
                                <small class="text-muted d-block">Gestão de sub-unidades</small>
                            </label>
                        </div>
                        
                        <!-- Permissões Específicas de Usuários -->
                        <div class="mt-4 pt-3 border-top">
                            <h6 class="text-secondary mb-3"><i class="fas fa-cogs"></i> Permissões Específicas de Usuários</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="USUARIOS_VISUALIZAR" id="USUARIOS_VISUALIZAR" 
                                               {% if 'USUARIOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="USUARIOS_VISUALIZAR" class="form-check-label">
                                            Visualizar Usuários
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="USUARIOS_CRIAR" id="USUARIOS_CRIAR" 
                                               {% if 'USUARIOS_CRIAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="USUARIOS_CRIAR" class="form-check-label">
                                            Criar Usuários
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="USUARIOS_EDITAR" id="USUARIOS_EDITAR" 
                                               {% if 'USUARIOS_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="USUARIOS_EDITAR" class="form-check-label">
                                            Editar Usuários
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="USUARIOS_ALTERAR_SENHA" id="USUARIOS_ALTERAR_SENHA" 
                                               {% if 'USUARIOS_ALTERAR_SENHA' in permissoes_dict %}checked{% endif %}>
                                        <label for="USUARIOS_ALTERAR_SENHA" class="form-check-label">
                                            Alterar Senhas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="USUARIOS_GERENCIAR_FUNCOES" id="USUARIOS_GERENCIAR_FUNCOES" 
                                               {% if 'USUARIOS_GERENCIAR_FUNCOES' in permissoes_dict %}checked{% endif %}>
                                        <label for="USUARIOS_GERENCIAR_FUNCOES" class="form-check-label">
                                            Gerenciar Funções
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
                        
            <!-- Relatórios -->
            <div class="accordion-card">
                <div class="card-header" id="headingRelatorios">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRelatorios" aria-expanded="false" aria-controls="collapseRelatorios">
                                <span><i class="fas fa-chart-bar text-success"></i> Relatórios</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-relatorios" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-relatorios" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="collapseRelatorios" class="collapse" aria-labelledby="headingRelatorios" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_RELATORIOS" id="MENU_RELATORIOS" 
                                   {% if 'MENU_RELATORIOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_RELATORIOS" class="form-check-label">
                                Relatórios
                                <small class="text-muted d-block">Geração de relatórios</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_RELATORIOS_MILITARES" id="SUBMENU_RELATORIOS_MILITARES" 
                                   {% if 'SUBMENU_RELATORIOS_MILITARES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_RELATORIOS_MILITARES" class="form-check-label">
                                Relatórios de Militares
                                <small class="text-muted d-block">Relatórios de militares</small>
                            </label>
                            </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_RELATORIOS_PROMOCOES" id="SUBMENU_RELATORIOS_PROMOCOES" 
                                   {% if 'SUBMENU_RELATORIOS_PROMOCOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_RELATORIOS_PROMOCOES" class="form-check-label">
                                Relatórios de Promoções
                                <small class="text-muted d-block">Relatórios de promoções</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_RELATORIOS_MEDALHAS" id="SUBMENU_RELATORIOS_MEDALHAS" 
                                   {% if 'SUBMENU_RELATORIOS_MEDALHAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_RELATORIOS_MEDALHAS" class="form-check-label">
                                Relatórios de Medalhas
                                <small class="text-muted d-block">Relatórios de medalhas</small>
                            </label>
                            </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_RELATORIOS_PUBLICACOES" id="SUBMENU_RELATORIOS_PUBLICACOES" 
                                   {% if 'SUBMENU_RELATORIOS_PUBLICACOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_RELATORIOS_PUBLICACOES" class="form-check-label">
                                Relatórios de Publicações
                                <small class="text-muted d-block">Relatórios de publicações</small>
                                        </label>
                                    </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_RELATORIOS_GERAIS" id="SUBMENU_RELATORIOS_GERAIS" 
                                   {% if 'SUBMENU_RELATORIOS_GERAIS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_RELATORIOS_GERAIS" class="form-check-label">
                                Relatórios Gerais
                                <small class="text-muted d-block">Relatórios gerais</small>
                            </label>
                        </div>
                        
                        <!-- Permissões Específicas de Relatórios -->
                        <div class="mt-4 pt-3 border-top">
                            <h6 class="text-success mb-3"><i class="fas fa-cogs"></i> Permissões Específicas de Relatórios</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="RELATORIOS_VISUALIZAR" id="RELATORIOS_VISUALIZAR" 
                                               {% if 'RELATORIOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="RELATORIOS_VISUALIZAR" class="form-check-label">
                                            Visualizar Relatórios
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="RELATORIOS_GERAR" id="RELATORIOS_GERAR" 
                                               {% if 'RELATORIOS_GERAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="RELATORIOS_GERAR" class="form-check-label">
                                            Gerar Relatórios
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="RELATORIOS_EXPORTAR" id="RELATORIOS_EXPORTAR" 
                                               {% if 'RELATORIOS_EXPORTAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="RELATORIOS_EXPORTAR" class="form-check-label">
                                            Exportar Relatórios
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="RELATORIOS_IMPRIMIR" id="RELATORIOS_IMPRIMIR" 
                                               {% if 'RELATORIOS_IMPRIMIR' in permissoes_dict %}checked{% endif %}>
                                        <label for="RELATORIOS_IMPRIMIR" class="form-check-label">
                                            Imprimir Relatórios
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Afastamentos -->
            <div class="accordion-card">
                <div class="card-header" id="headingAfastamentos">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseAfastamentos" aria-expanded="false" aria-controls="collapseAfastamentos">
                                <span><i class="fas fa-ban text-warning"></i> Afastamentos</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-afastamentos" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-afastamentos" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="collapseAfastamentos" class="collapse" aria-labelledby="headingAfastamentos" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <!-- Submenus de Afastamentos -->
                        <h6 class="text-warning mb-3"><i class="fas fa-list"></i> Submenus</h6>
                        
                        <!-- Submenu Férias -->
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_FERIAS" id="MENU_FERIAS" 
                                   {% if 'show_ferias' in permissoes_dict or 'MENU_FERIAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_FERIAS" class="form-check-label">
                                <i class="fas fa-umbrella-beach me-2"></i>Férias
                                <small class="text-muted d-block">Submenu de férias dos militares</small>
                            </label>
                        </div>
                        
                        <!-- Submenu Licença Especial -->
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="BOTAO_PLANO_LICENCA_ESPECIAL_VISUALIZAR" id="BOTAO_PLANO_LICENCA_ESPECIAL_VISUALIZAR" 
                                   {% if 'BOTAO_PLANO_LICENCA_ESPECIAL_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="BOTAO_PLANO_LICENCA_ESPECIAL_VISUALIZAR" class="form-check-label">
                                <i class="fas fa-certificate me-2"></i>Licença Especial
                                <small class="text-muted d-block">Submenu de licenças especiais</small>
                            </label>
                        </div>
                        
                        <!-- Submenu Outros (Afastamentos) -->
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_AFASTAMENTOS" id="MENU_AFASTAMENTOS" 
                                   {% if 'show_afastamentos' in permissoes_dict or 'MENU_AFASTAMENTOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_AFASTAMENTOS" class="form-check-label">
                                <i class="fas fa-ban me-2"></i>Outros
                                <small class="text-muted d-block">Submenu de outros tipos de afastamentos</small>
                            </label>
                        </div>
                        
                        <!-- Permissões Específicas de Afastamentos -->
                        <div class="mt-4">
                            <h6 class="text-warning mb-3"><i class="fas fa-cogs"></i> Permissões Específicas</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="AFASTAMENTOS_VISUALIZAR" id="AFASTAMENTOS_VISUALIZAR" 
                                               {% if 'AFASTAMENTOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="AFASTAMENTOS_VISUALIZAR" class="form-check-label">
                                            Visualizar Afastamentos
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="AFASTAMENTOS_CRIAR" id="AFASTAMENTOS_CRIAR" 
                                               {% if 'AFASTAMENTOS_CRIAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="AFASTAMENTOS_CRIAR" class="form-check-label">
                                            Criar Afastamentos
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="AFASTAMENTOS_EDITAR" id="AFASTAMENTOS_EDITAR" 
                                               {% if 'AFASTAMENTOS_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="AFASTAMENTOS_EDITAR" class="form-check-label">
                                            Editar Afastamentos
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="AFASTAMENTOS_EXCLUIR" id="AFASTAMENTOS_EXCLUIR" 
                                               {% if 'AFASTAMENTOS_EXCLUIR' in permissoes_dict %}checked{% endif %}>
                                        <label for="AFASTAMENTOS_EXCLUIR" class="form-check-label">
                                            Excluir Afastamentos
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Botões de Afastamento -->
                        <div class="mt-4 pt-3 border-top">
                            <h6 class="text-warning mb-3"><i class="fas fa-ban"></i> Botões de Afastamento</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="BOTAO_AFASTAMENTO_NOVO" id="BOTAO_AFASTAMENTO_NOVO" 
                                               {% if 'BOTAO_AFASTAMENTO_NOVO' in permissoes_dict %}checked{% endif %}>
                                        <label for="BOTAO_AFASTAMENTO_NOVO" class="form-check-label">
                                            <i class="fas fa-plus me-1"></i>Mostrar Botão "Novo Afastamento"
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="BOTAO_AFASTAMENTO_EDITAR" id="BOTAO_AFASTAMENTO_EDITAR" 
                                               {% if 'BOTAO_AFASTAMENTO_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="BOTAO_AFASTAMENTO_EDITAR" class="form-check-label">
                                            <i class="fas fa-edit me-1"></i>Mostrar Botão "Editar Afastamento"
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="BOTAO_AFASTAMENTO_EXCLUIR" id="BOTAO_AFASTAMENTO_EXCLUIR" 
                                               {% if 'BOTAO_AFASTAMENTO_EXCLUIR' in permissoes_dict %}checked{% endif %}>
                                        <label for="BOTAO_AFASTAMENTO_EXCLUIR" class="form-check-label">
                                            <i class="fas fa-trash me-1"></i>Mostrar Botão "Excluir Afastamento"
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="BOTAO_AFASTAMENTO_VISUALIZAR" id="BOTAO_AFASTAMENTO_VISUALIZAR" 
                                               {% if 'BOTAO_AFASTAMENTO_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="BOTAO_AFASTAMENTO_VISUALIZAR" class="form-check-label">
                                            <i class="fas fa-eye me-1"></i>Mostrar Botão "Visualizar Afastamento"
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Operações Planejadas -->
            <div class="accordion-card">
                <div class="card-header" id="headingPlanejadas">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePlanejadas" aria-expanded="false" aria-controls="collapsePlanejadas">
                                <span><i class="fas fa-clipboard-list text-warning"></i> Operações Planejadas</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-planejadas" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-planejadas" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="collapsePlanejadas" class="collapse" aria-labelledby="headingPlanejadas" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <!-- Menu Planejadas -->
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_PLANEJADAS" id="MENU_PLANEJADAS" 
                                   {% if 'MENU_PLANEJADAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_PLANEJADAS" class="form-check-label">
                                Menu Operações Planejadas
                                <small class="text-muted d-block">Acesso ao menu principal de planejadas</small>
                            </label>
                        </div>
                        
                        <!-- Submenu Planejadas -->
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_PLANEJADAS" id="SUBMENU_PLANEJADAS" 
                                   {% if 'SUBMENU_PLANEJADAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_PLANEJADAS" class="form-check-label">
                                Submenu Planejadas
                                <small class="text-muted d-block">Acesso ao submenu de planejadas</small>
                            </label>
                        </div>
                        
                        <!-- Operador de Planejadas -->
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_OPERADOR_PLANEJADAS" id="SUBMENU_OPERADOR_PLANEJADAS" 
                                   {% if 'SUBMENU_OPERADOR_PLANEJADAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_OPERADOR_PLANEJADAS" class="form-check-label">
                                Operador de Planejadas
                                <small class="text-muted d-block">Permissão para assinar como operador</small>
                            </label>
                        </div>
                        
                        <!-- Fiscal de Planejadas -->
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_FISCAL_PLANEJADAS" id="SUBMENU_FISCAL_PLANEJADAS" 
                                   {% if 'SUBMENU_FISCAL_PLANEJADAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_FISCAL_PLANEJADAS" class="form-check-label">
                                Fiscal de Planejadas
                                <small class="text-muted d-block">Permissão para assinar como fiscal</small>
                            </label>
                        </div>
                        
                        <!-- Permissões Específicas de Planejadas -->
                        <div class="mt-4">
                            <h6 class="text-warning mb-3"><i class="fas fa-cogs"></i> Permissões Específicas</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="PLANEJADAS_VISUALIZAR" id="PLANEJADAS_VISUALIZAR" 
                                               {% if 'PLANEJADAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="PLANEJADAS_VISUALIZAR" class="form-check-label">
                                            Visualizar Planejadas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="PLANEJADAS_CRIAR" id="PLANEJADAS_CRIAR" 
                                               {% if 'PLANEJADAS_CRIAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="PLANEJADAS_CRIAR" class="form-check-label">
                                            Criar Planejadas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="PLANEJADAS_EDITAR" id="PLANEJADAS_EDITAR" 
                                               {% if 'PLANEJADAS_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="PLANEJADAS_EDITAR" class="form-check-label">
                                            Editar Planejadas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="PLANEJADAS_EXCLUIR" id="PLANEJADAS_EXCLUIR" 
                                               {% if 'PLANEJADAS_EXCLUIR' in permissoes_dict %}checked{% endif %}>
                                        <label for="PLANEJADAS_EXCLUIR" class="form-check-label">
                                            Excluir Planejadas
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="PLANEJADAS_ADICIONAR_MILITAR" id="PLANEJADAS_ADICIONAR_MILITAR" 
                                               {% if 'PLANEJADAS_ADICIONAR_MILITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="PLANEJADAS_ADICIONAR_MILITAR" class="form-check-label">
                                            Adicionar Militar à Planejada
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="PLANEJADAS_REMOVER_MILITAR" id="PLANEJADAS_REMOVER_MILITAR" 
                                               {% if 'PLANEJADAS_REMOVER_MILITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="PLANEJADAS_REMOVER_MILITAR" class="form-check-label">
                                            Remover Militar da Planejada
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="PLANEJADAS_ASSINAR_OPERADOR" id="PLANEJADAS_ASSINAR_OPERADOR" 
                                               {% if 'PLANEJADAS_ASSINAR_OPERADOR' in permissoes_dict %}checked{% endif %}>
                                        <label for="PLANEJADAS_ASSINAR_OPERADOR" class="form-check-label">
                                            Assinar como Operador
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="PLANEJADAS_ASSINAR_FISCAL" id="PLANEJADAS_ASSINAR_FISCAL" 
                                               {% if 'PLANEJADAS_ASSINAR_FISCAL' in permissoes_dict %}checked{% endif %}>
                                        <label for="PLANEJADAS_ASSINAR_FISCAL" class="form-check-label">
                                            Assinar como Fiscal
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Frota -->
            <div class="accordion-card">
                <div class="card-header" id="headingFrota">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFrota" aria-expanded="false" aria-controls="collapseFrota">
                                <span><i class="fas fa-truck me-2"></i> Frota</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm ms-2" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-frota" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-frota" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="collapseFrota" class="collapse" aria-labelledby="headingFrota" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_FROTA" id="MENU_FROTA" 
                                   {% if 'MENU_FROTA_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_FROTA" class="form-check-label">
                                Frota
                                <small class="text-muted d-block">Menu principal de frota</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_VIATURAS" id="SUBMENU_VIATURAS" 
                                   {% if 'SUBMENU_VIATURAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_VIATURAS" class="form-check-label">
                                <i class="fas fa-car me-2"></i>Viaturas
                                <small class="text-muted d-block">Gestão de viaturas</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_CONTROLE_COMBUSTIVEL" id="SUBMENU_CONTROLE_COMBUSTIVEL" 
                                   {% if 'SUBMENU_CONTROLE_COMBUSTIVEL_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_CONTROLE_COMBUSTIVEL" class="form-check-label">
                                <i class="fas fa-gas-pump me-2"></i>Controle de Combustível
                                <small class="text-muted d-block">Gestão de abastecimentos</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_MANUTENCOES" id="SUBMENU_MANUTENCOES" 
                                   {% if 'SUBMENU_MANUTENCOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_MANUTENCOES" class="form-check-label">
                                <i class="fas fa-wrench me-2"></i>Manutenções
                                <small class="text-muted d-block">Gestão de manutenções</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_TROCAS_OLEO" id="SUBMENU_TROCAS_OLEO" 
                                   {% if 'SUBMENU_TROCAS_OLEO_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_TROCAS_OLEO" class="form-check-label">
                                <i class="fas fa-oil-can me-2"></i>Trocas de Óleo
                                <small class="text-muted d-block">Gestão de trocas de óleo</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_LICENCIAMENTOS" id="SUBMENU_LICENCIAMENTOS" 
                                   {% if 'SUBMENU_LICENCIAMENTOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_LICENCIAMENTOS" class="form-check-label">
                                <i class="fas fa-id-card me-2"></i>Licenciamentos
                                <small class="text-muted d-block">Gestão de licenciamentos</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_RODAGENS" id="SUBMENU_RODAGENS" 
                                   {% if 'SUBMENU_RODAGENS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_RODAGENS" class="form-check-label">
                                <i class="fas fa-route me-2"></i>Rodagens
                                <small class="text-muted d-block">Gestão de rodagens</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_PAINEL_GUARDA" id="SUBMENU_PAINEL_GUARDA" 
                                   {% if 'SUBMENU_PAINEL_GUARDA_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_PAINEL_GUARDA" class="form-check-label">
                                <i class="fas fa-tachometer-alt me-2"></i>Painel de Guarda
                                <small class="text-muted d-block">Painel de controle de guarda</small>
                            </label>
                        </div>
                        
                        <!-- Permissões Específicas de Frota -->
                        <div class="mt-4 pt-3 border-top">
                            <h6 class="text-warning mb-3"><i class="fas fa-cogs"></i> Permissões Específicas</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="VIATURAS_VISUALIZAR" id="VIATURAS_VISUALIZAR" 
                                               {% if 'VIATURAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="VIATURAS_VISUALIZAR" class="form-check-label">
                                            Visualizar Viaturas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="VIATURAS_CRIAR" id="VIATURAS_CRIAR" 
                                               {% if 'VIATURAS_CRIAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="VIATURAS_CRIAR" class="form-check-label">
                                            Criar Viaturas
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="VIATURAS_EDITAR" id="VIATURAS_EDITAR" 
                                               {% if 'VIATURAS_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="VIATURAS_EDITAR" class="form-check-label">
                                            Editar Viaturas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="VIATURAS_EXCLUIR" id="VIATURAS_EXCLUIR" 
                                               {% if 'VIATURAS_EXCLUIR' in permissoes_dict %}checked{% endif %}>
                                        <label for="VIATURAS_EXCLUIR" class="form-check-label">
                                            Excluir Viaturas
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Equipamentos Operacionais -->
            <div class="accordion-card">
                <div class="card-header" id="headingEquipamentosOperacionais">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseEquipamentosOperacionais" aria-expanded="false" aria-controls="collapseEquipamentosOperacionais">
                                <span><i class="fas fa-hard-hat me-2"></i> Equipamentos Operacionais</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm ms-2" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-equipamentos-operacionais" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-equipamentos-operacionais" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="collapseEquipamentosOperacionais" class="collapse" aria-labelledby="headingEquipamentosOperacionais" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_EQUIPAMENTOS_OPERACIONAIS" id="MENU_EQUIPAMENTOS_OPERACIONAIS" 
                                   {% if 'MENU_EQUIPAMENTOS_OPERACIONAIS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_EQUIPAMENTOS_OPERACIONAIS" class="form-check-label">
                                Equipamentos Operacionais
                                <small class="text-muted d-block">Menu principal de equipamentos operacionais</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_EQUIPAMENTOS_OPERACIONAIS" id="SUBMENU_EQUIPAMENTOS_OPERACIONAIS" 
                                   {% if 'SUBMENU_EQUIPAMENTOS_OPERACIONAIS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_EQUIPAMENTOS_OPERACIONAIS" class="form-check-label">
                                <i class="fas fa-hard-hat me-2"></i>Equipamentos Operacionais (Submenu)
                                <small class="text-muted d-block">Gestão de equipamentos operacionais</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_EQUIPAMENTOS_OPERACIONAIS_COMBUSTIVEL" id="SUBMENU_EQUIPAMENTOS_OPERACIONAIS_COMBUSTIVEL" 
                                   {% if 'SUBMENU_EQUIPAMENTOS_OPERACIONAIS_COMBUSTIVEL_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_EQUIPAMENTOS_OPERACIONAIS_COMBUSTIVEL" class="form-check-label">
                                <i class="fas fa-gas-pump me-2"></i>Controle de Combustível (Equipamentos)
                                <small class="text-muted d-block">Gestão de abastecimentos de equipamentos</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_EQUIPAMENTOS_OPERACIONAIS_MANUTENCOES" id="SUBMENU_EQUIPAMENTOS_OPERACIONAIS_MANUTENCOES" 
                                   {% if 'SUBMENU_EQUIPAMENTOS_OPERACIONAIS_MANUTENCOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_EQUIPAMENTOS_OPERACIONAIS_MANUTENCOES" class="form-check-label">
                                <i class="fas fa-wrench me-2"></i>Manutenções (Equipamentos)
                                <small class="text-muted d-block">Gestão de manutenções de equipamentos</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_EQUIPAMENTOS_OPERACIONAIS_TROCAS_OLEO" id="SUBMENU_EQUIPAMENTOS_OPERACIONAIS_TROCAS_OLEO" 
                                   {% if 'SUBMENU_EQUIPAMENTOS_OPERACIONAIS_TROCAS_OLEO_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_EQUIPAMENTOS_OPERACIONAIS_TROCAS_OLEO" class="form-check-label">
                                <i class="fas fa-oil-can me-2"></i>Trocas de Óleo (Equipamentos)
                                <small class="text-muted d-block">Gestão de trocas de óleo de equipamentos</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_EQUIPAMENTOS_OPERACIONAIS_TEMPOS_USO" id="SUBMENU_EQUIPAMENTOS_OPERACIONAIS_TEMPOS_USO" 
                                   {% if 'SUBMENU_EQUIPAMENTOS_OPERACIONAIS_TEMPOS_USO_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_EQUIPAMENTOS_OPERACIONAIS_TEMPOS_USO" class="form-check-label">
                                <i class="fas fa-clock me-2"></i>Controle de Uso por Horas
                                <small class="text-muted d-block">Gestão de tempos de uso de equipamentos</small>
                            </label>
                        </div>
                        
                        <!-- Permissões Específicas de Equipamentos Operacionais -->
                        <div class="mt-4 pt-3 border-top">
                            <h6 class="text-warning mb-3"><i class="fas fa-cogs"></i> Permissões Específicas</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="EQUIPAMENTOS_OPERACIONAIS_VISUALIZAR" id="EQUIPAMENTOS_OPERACIONAIS_VISUALIZAR" 
                                               {% if 'EQUIPAMENTOS_OPERACIONAIS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="EQUIPAMENTOS_OPERACIONAIS_VISUALIZAR" class="form-check-label">
                                            Visualizar Equipamentos Operacionais
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="EQUIPAMENTOS_OPERACIONAIS_CRIAR" id="EQUIPAMENTOS_OPERACIONAIS_CRIAR" 
                                               {% if 'EQUIPAMENTOS_OPERACIONAIS_CRIAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="EQUIPAMENTOS_OPERACIONAIS_CRIAR" class="form-check-label">
                                            Criar Equipamentos Operacionais
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="EQUIPAMENTOS_OPERACIONAIS_EDITAR" id="EQUIPAMENTOS_OPERACIONAIS_EDITAR" 
                                               {% if 'EQUIPAMENTOS_OPERACIONAIS_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="EQUIPAMENTOS_OPERACIONAIS_EDITAR" class="form-check-label">
                                            Editar Equipamentos Operacionais
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="EQUIPAMENTOS_OPERACIONAIS_EXCLUIR" id="EQUIPAMENTOS_OPERACIONAIS_EXCLUIR" 
                                               {% if 'EQUIPAMENTOS_OPERACIONAIS_EXCLUIR' in permissoes_dict %}checked{% endif %}>
                                        <label for="EQUIPAMENTOS_OPERACIONAIS_EXCLUIR" class="form-check-label">
                                            Excluir Equipamentos Operacionais
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Material Bélico -->
            <div class="accordion-card">
                <div class="card-header" id="headingMaterialBelico">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseMaterialBelico" aria-expanded="false" aria-controls="collapseMaterialBelico">
                                <span><i class="fas fa-gun me-2"></i> Material Bélico</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm ms-2" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-material-belico" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-material-belico" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="collapseMaterialBelico" class="collapse" aria-labelledby="headingMaterialBelico" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_MATERIAL_BELICO" id="MENU_MATERIAL_BELICO" 
                                   {% if 'MENU_MATERIAL_BELICO_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_MATERIAL_BELICO" class="form-check-label">
                                Material Bélico
                                <small class="text-muted d-block">Menu principal de material bélico</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ARMAS_INSTITUICAO" id="SUBMENU_ARMAS_INSTITUICAO" 
                                   {% if 'SUBMENU_ARMAS_INSTITUICAO_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ARMAS_INSTITUICAO" class="form-check-label">
                                <i class="fas fa-shield-alt me-2"></i>Armas da Instituição
                                <small class="text-muted d-block">Gestão de armas da instituição</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ARMAS_PARTICULARES" id="SUBMENU_ARMAS_PARTICULARES" 
                                   {% if 'SUBMENU_ARMAS_PARTICULARES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_ARMAS_PARTICULARES" class="form-check-label">
                                <i class="fas fa-user-shield me-2"></i>Armas Particulares
                                <small class="text-muted d-block">Gestão de armas particulares</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_CAUTELAS_ARMAS" id="SUBMENU_CAUTELAS_ARMAS" 
                                   {% if 'SUBMENU_CAUTELAS_ARMAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_CAUTELAS_ARMAS" class="form-check-label">
                                <i class="fas fa-shield-alt me-2"></i>Cautelas de Armas
                                <small class="text-muted d-block">Gestão de cautelas de armas</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_CONTROLE_MOVIMENTACOES" id="SUBMENU_CONTROLE_MOVIMENTACOES" 
                                   {% if 'SUBMENU_CONTROLE_MOVIMENTACOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_CONTROLE_MOVIMENTACOES" class="form-check-label">
                                <i class="fas fa-exchange-alt me-2"></i>Controle de Movimentações
                                <small class="text-muted d-block">Gestão de movimentações de armas</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_CONTROLE_MUNICAO" id="SUBMENU_CONTROLE_MUNICAO" 
                                   {% if 'SUBMENU_CONTROLE_MUNICAO_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_CONTROLE_MUNICAO" class="form-check-label">
                                <i class="fas fa-boxes me-2"></i>Controle de Munição
                                <small class="text-muted d-block">Gestão de munições</small>
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_CAUTELAS_MUNICOES" id="SUBMENU_CAUTELAS_MUNICOES" 
                                   {% if 'SUBMENU_CAUTELAS_MUNICOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="SUBMENU_CAUTELAS_MUNICOES" class="form-check-label">
                                <i class="fas fa-shield-alt me-2"></i>Cautelas de Munição
                                <small class="text-muted d-block">Gestão de cautelas de munições</small>
                            </label>
                        </div>
                        
                        <!-- Permissões Específicas de Material Bélico -->
                        <div class="mt-4 pt-3 border-top">
                            <h6 class="text-warning mb-3"><i class="fas fa-cogs"></i> Permissões Específicas</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="ARMAS_VISUALIZAR" id="ARMAS_VISUALIZAR" 
                                               {% if 'ARMAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="ARMAS_VISUALIZAR" class="form-check-label">
                                            Visualizar Armas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="ARMAS_CRIAR" id="ARMAS_CRIAR" 
                                               {% if 'ARMAS_CRIAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="ARMAS_CRIAR" class="form-check-label">
                                            Criar Armas
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="ARMAS_EDITAR" id="ARMAS_EDITAR" 
                                               {% if 'ARMAS_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="ARMAS_EDITAR" class="form-check-label">
                                            Editar Armas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="ARMAS_EXCLUIR" id="ARMAS_EXCLUIR" 
                                               {% if 'ARMAS_EXCLUIR' in permissoes_dict %}checked{% endif %}>
                                        <label for="ARMAS_EXCLUIR" class="form-check-label">
                                            Excluir Armas
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Permissões de Munições -->
                            <div class="row mt-3">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="MUNICOES_VISUALIZAR" id="MUNICOES_VISUALIZAR" 
                                               {% if 'MUNICOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="MUNICOES_VISUALIZAR" class="form-check-label">
                                            Visualizar Munições
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="MUNICOES_CRIAR" id="MUNICOES_CRIAR" 
                                               {% if 'MUNICOES_CRIAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="MUNICOES_CRIAR" class="form-check-label">
                                            Criar Munições
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="MUNICOES_EDITAR" id="MUNICOES_EDITAR" 
                                               {% if 'MUNICOES_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="MUNICOES_EDITAR" class="form-check-label">
                                            Editar Munições
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="MUNICOES_EXCLUIR" id="MUNICOES_EXCLUIR" 
                                               {% if 'MUNICOES_EXCLUIR' in permissoes_dict %}checked{% endif %}>
                                        <label for="MUNICOES_EXCLUIR" class="form-check-label">
                                            Excluir Munições
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bens Móveis -->
            <div class="accordion-card">
                <div class="card-header" id="headingBensMoveis">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseBensMoveis" aria-expanded="false" aria-controls="collapseBensMoveis">
                                <span><i class="fas fa-box text-success"></i> Bens Móveis</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm ms-2" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-bens-moveis" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-bens-moveis" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="collapseBensMoveis" class="collapse" aria-labelledby="headingBensMoveis" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_BENS_MOVEIS" id="MENU_BENS_MOVEIS" 
                                   {% if 'MENU_BENS_MOVEIS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_BENS_MOVEIS" class="form-check-label">
                                Bens Móveis
                                <small class="text-muted d-block">Menu principal de bens móveis</small>
                            </label>
                        </div>
                        
                        <!-- Permissões Específicas de Bens Móveis -->
                        <div class="mt-4 pt-3 border-top">
                            <h6 class="text-success mb-3"><i class="fas fa-cogs"></i> Permissões Específicas</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="BENS_MOVEIS_VISUALIZAR" id="BENS_MOVEIS_VISUALIZAR" 
                                               {% if 'BENS_MOVEIS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="BENS_MOVEIS_VISUALIZAR" class="form-check-label">
                                            Visualizar Bens Móveis
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="BENS_MOVEIS_CRIAR" id="BENS_MOVEIS_CRIAR" 
                                               {% if 'BENS_MOVEIS_CRIAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="BENS_MOVEIS_CRIAR" class="form-check-label">
                                            Criar Bens Móveis
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="BENS_MOVEIS_EDITAR" id="BENS_MOVEIS_EDITAR" 
                                               {% if 'BENS_MOVEIS_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="BENS_MOVEIS_EDITAR" class="form-check-label">
                                            Editar Bens Móveis
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="BENS_MOVEIS_EXCLUIR" id="BENS_MOVEIS_EXCLUIR" 
                                               {% if 'BENS_MOVEIS_EXCLUIR' in permissoes_dict %}checked{% endif %}>
                                        <label for="BENS_MOVEIS_EXCLUIR" class="form-check-label">
                                            Excluir Bens Móveis
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Processos Administrativos -->
            <div class="accordion-card">
                <div class="card-header" id="headingProcessos">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseProcessos" aria-expanded="false" aria-controls="collapseProcessos">
                                <span><i class="fas fa-folder-open text-primary"></i> Processos Administrativos</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm ms-2" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-processos" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-processos" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="collapseProcessos" class="collapse" aria-labelledby="headingProcessos" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_PROCESSOS" id="MENU_PROCESSOS" 
                                   {% if 'MENU_PROCESSOS_VISUALIZAR' in permissoes_dict or 'show_processos' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_PROCESSOS" class="form-check-label">
                                Processos Administrativos
                                <small class="text-muted d-block">Menu principal de processos administrativos</small>
                            </label>
                        </div>
                        
                        <!-- Permissões Específicas de Processos -->
                        <div class="mt-4 pt-3 border-top">
                            <h6 class="text-primary mb-3"><i class="fas fa-cogs"></i> Permissões Específicas de Processos</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="PROCESSOS_VISUALIZAR" id="PROCESSOS_VISUALIZAR" 
                                               {% if 'PROCESSOS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="PROCESSOS_VISUALIZAR" class="form-check-label">
                                            Visualizar Processos
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="PROCESSOS_CRIAR" id="PROCESSOS_CRIAR" 
                                               {% if 'PROCESSOS_CRIAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="PROCESSOS_CRIAR" class="form-check-label">
                                            Criar Processos
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="PROCESSOS_EDITAR" id="PROCESSOS_EDITAR" 
                                               {% if 'PROCESSOS_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="PROCESSOS_EDITAR" class="form-check-label">
                                            Editar Processos
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="PROCESSOS_EXCLUIR" id="PROCESSOS_EXCLUIR" 
                                               {% if 'PROCESSOS_EXCLUIR' in permissoes_dict %}checked{% endif %}>
                                        <label for="PROCESSOS_EXCLUIR" class="form-check-label">
                                            Excluir Processos
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-2">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="PROCESSOS_GERAR_PDF" id="PROCESSOS_GERAR_PDF" 
                                               {% if 'PROCESSOS_GERAR_PDF' in permissoes_dict %}checked{% endif %}>
                                        <label for="PROCESSOS_GERAR_PDF" class="form-check-label">
                                            Gerar PDF de Processos
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Separador Almoxarifado -->
            <div class="section-separator" data-label="ALMOXARIFADO" style="margin: 30px 0;"></div>
            
            <!-- Almoxarifado -->
            <div class="accordion-card">
                <div class="card-header" id="headingAlmoxarifado">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseAlmoxarifado" aria-expanded="false" aria-controls="collapseAlmoxarifado">
                                <span><i class="fas fa-warehouse text-info"></i> Almoxarifado</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm ms-2" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-almoxarifado" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-almoxarifado" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="collapseAlmoxarifado" class="collapse" aria-labelledby="headingAlmoxarifado" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input permission-checkbox" name="MENU_ALMOXARIFADO" id="MENU_ALMOXARIFADO" 
                                   {% if 'MENU_ALMOXARIFADO_VISUALIZAR' in permissoes_dict or 'show_almoxarifado' in permissoes_dict %}checked{% endif %}>
                            <label for="MENU_ALMOXARIFADO" class="form-check-label">
                                Almoxarifado
                                <small class="text-muted d-block">Menu principal de almoxarifado</small>
                            </label>
                        </div>
                        
                        <!-- Submenus do Almoxarifado -->
                        <div class="mt-3 pt-3 border-top">
                            <h6 class="text-secondary mb-3"><i class="fas fa-list"></i> Submenus do Almoxarifado</h6>
                            <div class="form-check mb-2">
                                <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ALMOXARIFADO_ITENS" id="SUBMENU_ALMOXARIFADO_ITENS" 
                                       {% if 'SUBMENU_ALMOXARIFADO_ITENS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                <label for="SUBMENU_ALMOXARIFADO_ITENS" class="form-check-label">
                                    <i class="fas fa-boxes me-2"></i>Itens
                                    <small class="text-muted d-block">Gestão de itens do almoxarifado</small>
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ALMOXARIFADO_ENTRADAS" id="SUBMENU_ALMOXARIFADO_ENTRADAS" 
                                       {% if 'SUBMENU_ALMOXARIFADO_ENTRADAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                <label for="SUBMENU_ALMOXARIFADO_ENTRADAS" class="form-check-label">
                                    <i class="fas fa-arrow-down me-2"></i>Entradas
                                    <small class="text-muted d-block">Registro de entradas de materiais</small>
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ALMOXARIFADO_SAIDAS" id="SUBMENU_ALMOXARIFADO_SAIDAS" 
                                       {% if 'SUBMENU_ALMOXARIFADO_SAIDAS_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                <label for="SUBMENU_ALMOXARIFADO_SAIDAS" class="form-check-label">
                                    <i class="fas fa-arrow-up me-2"></i>Saídas
                                    <small class="text-muted d-block">Registro de saídas de materiais</small>
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input type="checkbox" class="form-check-input permission-checkbox" name="SUBMENU_ALMOXARIFADO_REQUISICOES" id="SUBMENU_ALMOXARIFADO_REQUISICOES" 
                                       {% if 'SUBMENU_ALMOXARIFADO_REQUISICOES_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                <label for="SUBMENU_ALMOXARIFADO_REQUISICOES" class="form-check-label">
                                    <i class="fas fa-hand-holding me-2"></i>Requisições
                                    <small class="text-muted d-block">Requisições entre Organizações Militares</small>
                                </label>
                            </div>
                        </div>
                        
                        <!-- Permissões Específicas de Almoxarifado -->
                        <div class="mt-4 pt-3 border-top">
                            <h6 class="text-primary mb-3"><i class="fas fa-cogs"></i> Permissões Específicas de Almoxarifado</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="ALMOXARIFADO_VISUALIZAR" id="ALMOXARIFADO_VISUALIZAR" 
                                               {% if 'ALMOXARIFADO_VISUALIZAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="ALMOXARIFADO_VISUALIZAR" class="form-check-label">
                                            Visualizar Almoxarifado
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="ALMOXARIFADO_CRIAR" id="ALMOXARIFADO_CRIAR" 
                                               {% if 'ALMOXARIFADO_CRIAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="ALMOXARIFADO_CRIAR" class="form-check-label">
                                            Criar Itens/Entradas/Saídas
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="ALMOXARIFADO_EDITAR" id="ALMOXARIFADO_EDITAR" 
                                               {% if 'ALMOXARIFADO_EDITAR' in permissoes_dict %}checked{% endif %}>
                                        <label for="ALMOXARIFADO_EDITAR" class="form-check-label">
                                            Editar Itens/Entradas/Saídas
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input type="checkbox" class="form-check-input permission-checkbox" name="ALMOXARIFADO_EXCLUIR" id="ALMOXARIFADO_EXCLUIR" 
                                               {% if 'ALMOXARIFADO_EXCLUIR' in permissoes_dict %}checked{% endif %}>
                                        <label for="ALMOXARIFADO_EXCLUIR" class="form-check-label">
                                            Excluir Itens/Entradas/Saídas
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Controle de Botões na Interface -->
            <div class="accordion-card">
                <div class="card-header" id="headingBotoesInterface">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <button class="btn btn-link text-left d-flex align-items-center collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseBotoesInterface" aria-expanded="false" aria-controls="collapseBotoesInterface">
                                <span><i class="fas fa-mouse-pointer text-dark"></i> Controle de Botões na Interface</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </h6>
                        <div class="btn-group btn-group-sm" role="group">
                            <button type="button" class="btn btn-light btn-sm" id="select-all-botoes" data-bs-toggle="tooltip" title="Selecionar todos">
                                <i class="fas fa-check-square"></i>
                            </button>
                            <button type="button" class="btn btn-light btn-sm" id="deselect-all-botoes" data-bs-toggle="tooltip" title="Desmarcar todos">
                                <i class="fas fa-square"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="collapseBotoesInterface" class="collapse" aria-labelledby="headingBotoesInterface" data-bs-parent="#mainAccordion">
                    <div class="card-body">
                        <p class="text-muted">Nenhum botão adicional configurado no momento. Todos os botões foram movidos para seus respectivos acordeons.</p>
                    </div>
                </div>
            </div>
                            
                            
            <!-- Botões de Ação -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <button type="button" class="btn btn-outline-primary" id="select-all" data-bs-toggle="tooltip" title="Selecionar todas as permissões">
                                <i class="fas fa-check-square"></i> Selecionar Todos
                            </button>
                            <button type="button" class="btn btn-outline-secondary" id="deselect-all" data-bs-toggle="tooltip" title="Desmarcar todas as permissões">
                                <i class="fas fa-square"></i> Desmarcar Todos
                            </button>
                            <button type="button" class="btn btn-outline-warning" id="force-hide-loading" data-bs-toggle="tooltip" title="Remover loading se estiver travado">
                                <i class="fas fa-times-circle"></i> Remover Loading
                            </button>
                                </div>
                        <div>
                            <button type="submit" class="btn btn-success" data-bs-toggle="tooltip" title="Salvar todas as permissões selecionadas (Ctrl+S)">
                                <i class="fas fa-save"></i> Salvar Permissões
                            </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                </div>
            </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Aguardar o DOM estar pronto
document.addEventListener('DOMContentLoaded', function() {
    console.log('Sistema de permissões carregado com sucesso!');
    
    // ===== FUNCIONALIDADES DOS BOTÕES SELECIONAR TODOS =====
    
    // Função para selecionar/deselecionar todos os checkboxes de um acordeão
    function toggleAllCheckboxes(accordionId, select) {
        console.log('toggleAllCheckboxes chamada:', accordionId, select);
        
        // Tentar encontrar pelo ID diretamente primeiro
        let accordion = document.getElementById(accordionId);
        
        // Se não encontrar, tentar encontrar pela classe collapse e data-bs-target
        if (!accordion) {
            const accordionButton = document.querySelector(`[data-bs-target="#${accordionId}"]`);
            if (accordionButton) {
                // Encontrar o elemento pai que contém o card-body
                const card = accordionButton.closest('.card');
                if (card) {
                    accordion = card.querySelector(`#${accordionId}, .collapse, .card-body`);
                }
            }
        }
        
        // Se ainda não encontrou, tentar encontrar pelo card completo do acordeon
        if (!accordion) {
            const cardHeader = document.querySelector(`#heading${accordionId.replace('collapse', '')}`);
            if (cardHeader) {
                const card = cardHeader.closest('.card');
                if (card) {
                    accordion = card.querySelector(`#${accordionId}, .collapse, .card-body`);
                }
            }
        }
        
        // Última tentativa: buscar diretamente pelo ID ou pela classe
        if (!accordion) {
            accordion = document.querySelector(`#${accordionId}`);
        }
        
        if (!accordion) {
            console.log('Acordeão não encontrado:', accordionId);
            // Tentar expandir o acordeon primeiro e depois buscar novamente
            const accordionButton = document.querySelector(`[data-bs-target="#${accordionId}"]`);
            if (accordionButton && accordionButton.classList.contains('collapsed')) {
                accordionButton.click(); // Expandir acordeon
                setTimeout(() => {
                    accordion = document.getElementById(accordionId);
                    if (accordion) {
                        const checkboxes = accordion.querySelectorAll('input.permission-checkbox[type="checkbox"]');
                        checkboxes.forEach(checkbox => {
                            checkbox.checked = select;
                            checkbox.dispatchEvent(new Event('change', { bubbles: true }));
                        });
                        console.log('Checkboxes atualizados após expandir:', checkboxes.length);
                    }
                }, 300);
            }
            return;
        }
        
        // Expandir acordeon se estiver fechado (para garantir que os checkboxes estão visíveis)
        const accordionButton = document.querySelector(`[data-bs-target="#${accordionId}"]`);
        if (accordionButton && accordionButton.classList.contains('collapsed')) {
            // Expandir primeiro
            const bsCollapse = new bootstrap.Collapse(accordion, { toggle: false });
            bsCollapse.show();
        }
        
        // Buscar checkboxes dentro do acordeon encontrado (mesmo que não esteja visível)
        const checkboxes = accordion.querySelectorAll('input.permission-checkbox[type="checkbox"]');
        console.log('Checkboxes encontrados:', checkboxes.length);
        
        if (checkboxes.length === 0) {
            console.log('Nenhum checkbox encontrado. Tentando buscar no card pai...');
            const card = accordion.closest('.card');
            if (card) {
                const allCheckboxes = card.querySelectorAll('input.permission-checkbox[type="checkbox"]');
                console.log('Checkboxes encontrados no card:', allCheckboxes.length);
                allCheckboxes.forEach(checkbox => {
                    checkbox.checked = select;
                    checkbox.dispatchEvent(new Event('change', { bubbles: true }));
                });
                // Atualizar contador
                if (typeof updatePermissionCounter === 'function') {
                    updatePermissionCounter();
                }
                return;
            }
        }
        
        checkboxes.forEach(checkbox => {
            checkbox.checked = select;
            // Disparar evento change para garantir que outros listeners sejam notificados
            checkbox.dispatchEvent(new Event('change', { bubbles: true }));
        });
        
        // Atualizar contador
        if (typeof updatePermissionCounter === 'function') {
            updatePermissionCounter();
        }
        
        // Mostrar notificação
        const action = select ? 'selecionadas' : 'desmarcadas';
        const count = checkboxes.length;
        if (typeof showNotification === 'function') {
            showNotification(`${count} permissões ${action}`, 'info');
        } else {
            console.log(`${count} permissões ${action}`);
        }
    }
    
    // Configurar botões para cada acordeão
    const accordionButtons = {
        'select-all-dashboard': () => toggleAllCheckboxes('collapseDashboard', true),
        'deselect-all-dashboard': () => toggleAllCheckboxes('collapseDashboard', false),
        'select-all-pessoal': () => toggleAllCheckboxes('collapsePessoal', true),
        'deselect-all-pessoal': () => toggleAllCheckboxes('collapsePessoal', false),
        'select-all-efetivo': () => toggleAllCheckboxes('collapseEfetivo', true),
        'deselect-all-efetivo': () => toggleAllCheckboxes('collapseEfetivo', false),
        'select-all-promocoes': () => toggleAllCheckboxes('collapsePromocoes', true),
        'deselect-all-promocoes': () => toggleAllCheckboxes('collapsePromocoes', false),
        'select-all-medalhas': () => toggleAllCheckboxes('collapseMedalhas', true),
        'deselect-all-medalhas': () => toggleAllCheckboxes('collapseMedalhas', false),
        'select-all-publicacoes': () => toggleAllCheckboxes('collapsePublicacoes', true),
        'deselect-all-publicacoes': () => toggleAllCheckboxes('collapsePublicacoes', false),
        'select-all-afastamentos': () => toggleAllCheckboxes('collapseAfastamentos', true),
        'deselect-all-afastamentos': () => toggleAllCheckboxes('collapseAfastamentos', false),
        'select-all-planejadas': () => toggleAllCheckboxes('collapsePlanejadas', true),
        'deselect-all-planejadas': () => toggleAllCheckboxes('collapsePlanejadas', false),
        'select-all-escalas': () => toggleAllCheckboxes('collapseEscalas', true),
        'deselect-all-escalas': () => toggleAllCheckboxes('collapseEscalas', false),
        'select-all-configuracoes': () => toggleAllCheckboxes('collapseConfiguracoes', true),
        'deselect-all-configuracoes': () => toggleAllCheckboxes('collapseConfiguracoes', false),
        'select-all-relatorios': () => toggleAllCheckboxes('collapseRelatorios', true),
        'deselect-all-relatorios': () => toggleAllCheckboxes('collapseRelatorios', false),
        'select-all-permissoes-especificas': () => toggleAllCheckboxes('collapsePermissoesEspecificas', true),
        'deselect-all-permissoes-especificas': () => toggleAllCheckboxes('collapsePermissoesEspecificas', false),
        'select-all-processos': () => toggleAllCheckboxes('collapseProcessos', true),
        'deselect-all-processos': () => toggleAllCheckboxes('collapseProcessos', false),
        'select-all-almoxarifado': () => toggleAllCheckboxes('collapseAlmoxarifado', true),
        'deselect-all-almoxarifado': () => toggleAllCheckboxes('collapseAlmoxarifado', false),
        'select-all-bens-moveis': () => toggleAllCheckboxes('collapseBensMoveis', true),
        'deselect-all-bens-moveis': () => toggleAllCheckboxes('collapseBensMoveis', false),
        'select-all-frota': () => toggleAllCheckboxes('collapseFrota', true),
        'deselect-all-frota': () => toggleAllCheckboxes('collapseFrota', false),
        'select-all-equipamentos-operacionais': () => toggleAllCheckboxes('collapseEquipamentosOperacionais', true),
        'deselect-all-equipamentos-operacionais': () => toggleAllCheckboxes('collapseEquipamentosOperacionais', false),
    };
    
    // Adicionar event listeners para todos os botões
    console.log('Configurando botões select all...');
    Object.keys(accordionButtons).forEach(buttonId => {
        const button = document.getElementById(buttonId);
        if (button) {
            console.log('Event listener adicionado para:', buttonId);
            button.addEventListener('click', function(e) {
                e.preventDefault();
                console.log('Botão clicado:', buttonId);
                accordionButtons[buttonId]();
            });
        } else {
            console.log('Botão não encontrado:', buttonId);
        }
    });
    
    // Teste adicional - verificar se pelo menos um botão existe
    const testButton = document.getElementById('select-all-dashboard');
    if (testButton) {
        console.log('Botão de teste encontrado:', testButton);
    } else {
        console.log('Nenhum botão encontrado!');
    }
    
    // ===== FUNCIONALIDADES DOS BOTÕES =====
    
    // Selecionar todos os checkboxes
    const selectAllBtn = document.getElementById('select-all');
    if (selectAllBtn) {
        selectAllBtn.addEventListener('click', function() {
            const checkboxes = document.querySelectorAll('.permission-checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.checked = true;
            });
            showNotification('Todos os checkboxes foram selecionados', 'success');
            updatePermissionCounter();
        });
    }
    
    // Desmarcar todos os checkboxes
    const deselectAllBtn = document.getElementById('deselect-all');
    if (deselectAllBtn) {
        deselectAllBtn.addEventListener('click', function() {
            const checkboxes = document.querySelectorAll('.permission-checkbox');
        checkboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
            showNotification('Todos os checkboxes foram desmarcados', 'info');
            updatePermissionCounter();
        });
    }
    
    // Botão de emergência para remover loading
    const forceHideLoadingBtn = document.getElementById('force-hide-loading');
    if (forceHideLoadingBtn) {
        forceHideLoadingBtn.addEventListener('click', function() {
            forceHideLoading();
            showNotification('Loading removido manualmente', 'info');
        });
    }
    
    // Expandir todos os acordeons
    const expandAllBtn = document.getElementById('expand-all-page');
    if (expandAllBtn) {
        expandAllBtn.addEventListener('click', function() {
            const collapses = document.querySelectorAll('.collapse');
            collapses.forEach(collapse => {
                collapse.classList.add('show');
                collapse.style.display = 'block';
                
                const button = collapse.previousElementSibling.querySelector('button');
                if (button) {
                    button.classList.remove('collapsed');
                    button.setAttribute('aria-expanded', 'true');
                    
                    const chevron = button.querySelector('.fa-chevron-down');
                    if (chevron) {
                        chevron.classList.remove('fa-chevron-down');
                        chevron.classList.add('fa-chevron-up');
                    }
                }
            });
            showNotification('Todos os acordeons foram expandidos', 'info');
        });
    }
    
    // Colapsar todos os acordeons
    const collapseAllBtn = document.getElementById('collapse-all-page');
    if (collapseAllBtn) {
        collapseAllBtn.addEventListener('click', function() {
            const collapses = document.querySelectorAll('.collapse');
            collapses.forEach(collapse => {
                collapse.classList.remove('show');
                collapse.style.display = 'none';
                
                const button = collapse.previousElementSibling.querySelector('button');
                if (button) {
                    button.classList.add('collapsed');
                    button.setAttribute('aria-expanded', 'false');
                    
                    const chevron = button.querySelector('.fa-chevron-up');
                    if (chevron) {
                        chevron.classList.remove('fa-chevron-up');
                        chevron.classList.add('fa-chevron-down');
                    }
                }
            });
            showNotification('Todos os acordeons foram colapsados', 'info');
        });
    }
    
    // ===== FUNCIONALIDADES DOS ACORDEONS =====
    
    // Animações dos acordeons
    const collapseElements = document.querySelectorAll('.collapse');
    collapseElements.forEach(collapse => {
        collapse.addEventListener('show.bs.collapse', function() {
            const chevron = this.previousElementSibling.querySelector('.fa-chevron-down');
            if (chevron) {
                chevron.classList.remove('fa-chevron-down');
                chevron.classList.add('fa-chevron-up');
            }
        });
        
        collapse.addEventListener('hide.bs.collapse', function() {
            const chevron = this.previousElementSibling.querySelector('.fa-chevron-up');
            if (chevron) {
                chevron.classList.remove('fa-chevron-up');
                chevron.classList.add('fa-chevron-down');
            }
        });
    });
    
    // ===== FUNCIONALIDADES DO FORMULÁRIO =====
    
    // Submissão do formulário - VERSÃO ULTRA SIMPLIFICADA
    const form = document.getElementById('permissions-form');
    if (form) {
        form.addEventListener('submit', function(e) {
            console.log('DEBUG: Formulário sendo enviado...');
            
            // Verificar se há checkboxes selecionados
            const checkedBoxes = document.querySelectorAll('.permission-checkbox:checked');
            console.log('DEBUG: Checkboxes selecionados:', checkedBoxes.length);
            
            if (checkedBoxes.length === 0) {
                if (!confirm('Nenhuma permissão foi selecionada. Deseja continuar mesmo assim?')) {
                    e.preventDefault();
                    return false;
                }
            }
            
            // Mostrar loading
            showLoading(true);
            
            // Permitir envio normal do formulário
            console.log('DEBUG: Permitindo envio tradicional do formulario...');
        });
    }
    
    
    // ===== FUNCIONALIDADES ADICIONAIS =====
    
    // Contador de permissões selecionadas
    function updatePermissionCounter() {
        const total = document.querySelectorAll('.permission-checkbox').length;
        const selected = document.querySelectorAll('.permission-checkbox:checked').length;
        const saveBtn = document.querySelector('.btn-success');
        
        if (saveBtn) {
            if (selected > 0) {
                saveBtn.innerHTML = `<i class="fas fa-save"></i> Salvar Permissões (${selected}/${total})`;
            } else {
                saveBtn.innerHTML = '<i class="fas fa-save"></i> Salvar Permissões';
            }
        }
    }
    
    // Atualizar contador quando checkboxes mudarem
    const checkboxes = document.querySelectorAll('.permission-checkbox');
    checkboxes.forEach(checkbox => {
        checkbox.addEventListener('change', updatePermissionCounter);
    });
    
    // Inicializar contador
    updatePermissionCounter();
    
    // ===== BOTÕES DE SELEÇÃO POR SEÇÃO =====
    
    // Ensino - Selecionar todos
    const selectAllEnsino = document.getElementById('select-all-ensino');
    if (selectAllEnsino) {
        selectAllEnsino.addEventListener('click', function() {
            const checkboxes = document.querySelectorAll('#collapseEnsino .permission-checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.checked = true;
            });
            updatePermissionCounter();
        });
    }
    
    // Ensino - Desmarcar todos
    const deselectAllEnsino = document.getElementById('deselect-all-ensino');
    if (deselectAllEnsino) {
        deselectAllEnsino.addEventListener('click', function() {
            const checkboxes = document.querySelectorAll('#collapseEnsino .permission-checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
            updatePermissionCounter();
        });
    }
    
    // ===== FUNÇÕES AUXILIARES =====
    
    // Mostrar/ocultar loading
    function showLoading(show) {
        // Criar loading se não existir
        let loading = document.getElementById('loading');
        if (!loading) {
            loading = document.createElement('div');
            loading.id = 'loading';
            loading.className = 'position-fixed top-0 start-0 w-100 h-100 d-flex justify-content-center align-items-center';
            loading.style.cssText = 'background: rgba(0,0,0,0.5); z-index: 9999;';
            loading.innerHTML = `
                <div class="text-center text-white">
                    <div class="spinner-border mb-3" role="status">
                        <span class="visually-hidden">Carregando...</span>
                    </div>
                    <p>Salvando permissões...</p>
                </div>
            `;
            document.body.appendChild(loading);
        }
        loading.style.display = show ? 'flex' : 'none';
    }
    
    // Função para forçar remoção do loading
    function forceHideLoading() {
        const loading = document.getElementById('loading');
        if (loading) {
            loading.style.display = 'none';
            loading.remove();
            console.log('Loading removido forçadamente');
        }
    }
    
    // Mostrar notificações
    function showNotification(message, type) {
        const alertClass = type === 'success' ? 'alert-success' : 
                          type === 'error' ? 'alert-danger' : 
                          type === 'warning' ? 'alert-warning' : 'alert-info';
        
        const icon = type === 'success' ? 'fas fa-check-circle' : 
                    type === 'error' ? 'fas fa-exclamation-circle' : 
                    type === 'warning' ? 'fas fa-exclamation-triangle' : 'fas fa-info-circle';
        
        const notification = document.createElement('div');
        notification.className = `alert ${alertClass} alert-dismissible fade show position-fixed`;
        notification.style.cssText = 'top: 20px; right: 20px; z-index: 10000; min-width: 300px;';
        notification.innerHTML = `
            <i class="${icon} me-2"></i>
            ${message}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
            if (notification.parentNode) {
                notification.remove();
            }
        }, 5000);
    }
    
    // Inicializar tooltips
    const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    tooltipTriggerList.map(function (tooltipTriggerEl) {
        if (typeof bootstrap !== 'undefined' && bootstrap.Tooltip) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
        }
    });
    
    // Atalhos de teclado
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.keyCode === 83) {
            e.preventDefault();
            if (form) {
                form.dispatchEvent(new Event('submit'));
            }
        }
        
        if (e.ctrlKey && e.keyCode === 65) {
            e.preventDefault();
            if (selectAllBtn) {
                selectAllBtn.click();
            }
        }
        
        if (e.ctrlKey && e.keyCode === 68) {
            e.preventDefault();
            if (deselectAllBtn) {
                deselectAllBtn.click();
            }
        }
        
        if (e.ctrlKey && e.keyCode === 82) { // Ctrl+R para remover loading
            e.preventDefault();
            forceHideLoading();
            showNotification('Loading removido via atalho (Ctrl+R)', 'info');
        }
    });
});
</script>
{% endblock %}
