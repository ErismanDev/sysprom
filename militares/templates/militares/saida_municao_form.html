{% extends 'base.html' %}
{% load static %}

{% block title %}Registrar Saída de Munição{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h2 class="mb-0">
                        <i class="fas fa-arrow-up text-warning me-2"></i>Registrar Saída de Munição
                    </h2>
                    <p class="text-muted mb-0">Registrar saída de munição do estoque</p>
                </div>
                <div>
                    <a href="{% url 'militares:saida_municao_list' %}" class="btn btn-outline-secondary">
                        <i class="fas fa-arrow-left me-2"></i>Voltar
                    </a>
                </div>
            </div>
            
            <div class="card">
                <div class="card-body">
                    <form method="post">
                        {% csrf_token %}
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.municao.id_for_label }}" class="form-label">
                                    {{ form.municao.label }} <span class="text-danger">*</span>
                                </label>
                                {{ form.municao }}
                                {% if form.municao.errors %}
                                    <div class="text-danger small">{{ form.municao.errors }}</div>
                                {% endif %}
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.quantidade.id_for_label }}" class="form-label">
                                    {{ form.quantidade.label }} <span class="text-danger">*</span>
                                </label>
                                {{ form.quantidade }}
                                {% if form.quantidade.errors %}
                                    <div class="text-danger small">{{ form.quantidade.errors }}</div>
                                {% endif %}
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.tipo_saida.id_for_label }}" class="form-label">
                                    {{ form.tipo_saida.label }} <span class="text-danger">*</span>
                                </label>
                                {{ form.tipo_saida }}
                                {% if form.tipo_saida.errors %}
                                    <div class="text-danger small">{{ form.tipo_saida.errors }}</div>
                                {% endif %}
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.data_saida.id_for_label }}" class="form-label">
                                    {{ form.data_saida.label }} <span class="text-danger">*</span>
                                </label>
                                {{ form.data_saida }}
                                {% if form.data_saida.errors %}
                                    <div class="text-danger small">{{ form.data_saida.errors }}</div>
                                {% endif %}
                            </div>
                            
                            <div class="col-md-6 mb-3" id="cautela_individual_field" style="display: none;">
                                <label for="{{ form.cautela_individual.id_for_label }}" class="form-label">
                                    {{ form.cautela_individual.label }}
                                </label>
                                {{ form.cautela_individual }}
                                {% if form.cautela_individual.errors %}
                                    <div class="text-danger small">{{ form.cautela_individual.errors }}</div>
                                {% endif %}
                            </div>
                            
                            <div class="col-md-6 mb-3" id="cautela_coletiva_field" style="display: none;">
                                <label for="{{ form.cautela_coletiva.id_for_label }}" class="form-label">
                                    {{ form.cautela_coletiva.label }}
                                </label>
                                {{ form.cautela_coletiva }}
                                {% if form.cautela_coletiva.errors %}
                                    <div class="text-danger small">{{ form.cautela_coletiva.errors }}</div>
                                {% endif %}
                            </div>
                            
                            <div class="col-md-12 mb-3">
                                <label for="{{ form.observacoes.id_for_label }}" class="form-label">
                                    {{ form.observacoes.label }}
                                </label>
                                {{ form.observacoes }}
                                {% if form.observacoes.errors %}
                                    <div class="text-danger small">{{ form.observacoes.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        
                        {% if form.non_field_errors %}
                            <div class="alert alert-danger">
                                {{ form.non_field_errors }}
                            </div>
                        {% endif %}
                        
                        <div class="d-flex justify-content-end gap-2 mt-4">
                            <a href="{% url 'militares:saida_municao_list' %}" class="btn btn-outline-secondary">
                                <i class="fas fa-times me-2"></i>Cancelar
                            </a>
                            <button type="submit" class="btn btn-warning">
                                <i class="fas fa-save me-2"></i>Registrar Saída
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const tipoSaidaSelect = document.getElementById('{{ form.tipo_saida.id_for_label }}');
    const cautelaIndividualField = document.getElementById('cautela_individual_field');
    const cautelaColetivaField = document.getElementById('cautela_coletiva_field');
    
    function toggleCautelaFields() {
        const tipoSaida = tipoSaidaSelect.value;
        if (tipoSaida === 'CAUTELA_INDIVIDUAL') {
            cautelaIndividualField.style.display = 'block';
            cautelaColetivaField.style.display = 'none';
        } else if (tipoSaida === 'CAUTELA_COLETIVA') {
            cautelaIndividualField.style.display = 'none';
            cautelaColetivaField.style.display = 'block';
        } else {
            cautelaIndividualField.style.display = 'none';
            cautelaColetivaField.style.display = 'none';
        }
    }
    
    tipoSaidaSelect.addEventListener('change', toggleCautelaFields);
    toggleCautelaFields(); // Executar na carga inicial
});
</script>
{% endblock %}

