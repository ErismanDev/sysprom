{% extends 'base.html' %}
{% load static %}

{% block title %}Teste de Permiss√µes{% endblock %}

{% block content %}
<div class="container-fluid">
    <h1>Teste de Permiss√µes Granulares</h1>
    
    <form method="post" id="test-form">
        {% csrf_token %}
        
        <div class="card mb-3">
            <div class="card-header">
                <h5>Teste de Salvamento</h5>
            </div>
            <div class="card-body">
                <div class="form-check mb-2">
                    <input type="checkbox" class="form-check-input" name="show_dashboard" id="show_dashboard" 
                           {% if 'show_dashboard' in permissoes_dict %}checked{% endif %}>
                    <label for="show_dashboard" class="form-check-label">
                        Dashboard
                    </label>
                </div>
                
                <div class="form-check mb-2">
                    <input type="checkbox" class="form-check-input" name="show_efetivo" id="show_efetivo" 
                           {% if 'show_efetivo' in permissoes_dict %}checked{% endif %}>
                    <label for="show_efetivo" class="form-check-label">
                        Efetivo
                    </label>
                </div>
                
                <div class="form-check mb-2">
                    <input type="checkbox" class="form-check-input" name="show_ativos" id="show_ativos" 
                           {% if 'show_ativos' in permissoes_dict %}checked{% endif %}>
                    <label for="show_ativos" class="form-check-label">
                        Ativos
                    </label>
                </div>
                
                <div class="form-check mb-2">
                    <input type="checkbox" class="form-check-input" name="show_inativos" id="show_inativos" 
                           {% if 'show_inativos' in permissoes_dict %}checked{% endif %}>
                    <label for="show_inativos" class="form-check-label">
                        Inativos
                    </label>
                </div>
                
                <div class="form-check mb-2">
                    <input type="checkbox" class="form-check-input" name="show_lotacoes" id="show_lotacoes" 
                           {% if 'show_lotacoes' in permissoes_dict %}checked{% endif %}>
                    <label for="show_lotacoes" class="form-check-label">
                        Lota√ß√µes
                    </label>
                </div>
            </div>
        </div>
        
        <button type="submit" class="btn btn-primary">Salvar Teste</button>
    </form>
    
    <div class="mt-4">
        <h5>Debug Info:</h5>
        <p><strong>Fun√ß√£o:</strong> {{ funcao.nome }}</p>
        <p><strong>Total de permiss√µes:</strong> {{ total_permissoes }}</p>
        <p><strong>Permiss√µes ativas:</strong> {{ permissoes_ativas }}</p>
        <p><strong>Permiss√µes dict:</strong> {{ permissoes_dict }}</p>
    </div>
</div>

<script>
document.getElementById('test-form').addEventListener('submit', function(e) {
    console.log('üîç Debug: Formul√°rio de teste sendo enviado...');
    
    const checkboxes = document.querySelectorAll('input[type="checkbox"]:checked');
    console.log(`üìä Total de checkboxes marcados: ${checkboxes.length}`);
    
    checkboxes.forEach(checkbox => {
        console.log(`‚úÖ Campo marcado: ${checkbox.name} = ${checkbox.value}`);
    });
});
</script>
{% endblock %}
