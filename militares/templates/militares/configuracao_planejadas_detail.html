{% extends 'base.html' %}
{% load static %}

{% block title %}{{ page_title }}{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Cabeçalho -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h1 class="h3 mb-0">{{ page_title }}</h1>
                    <p class="text-muted mb-0">Detalhes da configuração de planejadas</p>
                </div>
                <div>
                    <a href="{% url 'militares:configuracao_planejadas_list' %}" class="btn btn-outline-secondary">
                        <i class="fas fa-arrow-left me-2"></i>Voltar
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Status da Configuração -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card {% if configuracao.ativo %}border-success{% else %}border-secondary{% endif %}">
                <div class="card-header {% if configuracao.ativo %}bg-success text-white{% else %}bg-secondary text-white{% endif %}">
                    <h5 class="mb-0">
                        <i class="fas {% if configuracao.ativo %}fa-check-circle{% else %}fa-pause-circle{% endif %} me-2"></i>
                        {% if configuracao.ativo %}Configuração Ativa{% else %}Configuração Inativa{% endif %}
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <strong>Criado em:</strong>
                            <p class="text-muted">{{ configuracao.data_criacao|date:"d/m/Y H:i" }}</p>
                        </div>
                        <div class="col-md-6">
                            <strong>Última atualização:</strong>
                            <p class="text-muted">{{ configuracao.data_atualizacao|date:"d/m/Y H:i" }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Configurações Básicas -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header">
                    <h5 class="mb-0 text-primary">
                        <i class="fas fa-cog me-2"></i>Configurações Básicas
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="text-center p-3 border rounded">
                                <i class="fas fa-users fa-2x text-primary mb-2"></i>
                                <h4 class="text-primary">{{ configuracao.quantidade_planejadas_por_militar_mes }}</h4>
                                <p class="text-muted mb-0">Planejadas por Militar/Mês</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="text-center p-3 border rounded">
                                <i class="fas fa-dollar-sign fa-2x text-success mb-2"></i>
                                <h4 class="text-success">{{ configuracao.valor_planejada_normal_formatado }}</h4>
                                <p class="text-muted mb-0">Valor Normal</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="text-center p-3 border rounded">
                                <i class="fas fa-calendar-week fa-2x text-warning mb-2"></i>
                                <h4 class="text-warning">{{ configuracao.valor_planejada_fim_semana_formatado }}</h4>
                                <p class="text-muted mb-0">Valor Fim de Semana</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Configurações de Tipos de Planejadas -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header">
                    <h5 class="mb-0 text-primary">
                        <i class="fas fa-clock me-2"></i>Configurações de Tipos de Planejadas
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="text-center p-3 border rounded">
                                <i class="fas fa-sun fa-2x text-warning mb-2"></i>
                                <h4 class="text-primary">{{ configuracao.horas_planejada_p1 }}h</h4>
                                <p class="text-muted mb-0">Planejada P1</p>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="text-center p-3 border rounded">
                                <i class="fas fa-sun fa-2x text-orange mb-2"></i>
                                <h4 class="text-primary">{{ configuracao.horas_planejada_p2 }}h</h4>
                                <p class="text-muted mb-0">Planejada P2</p>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="text-center p-3 border rounded">
                                <i class="fas fa-moon fa-2x text-info mb-2"></i>
                                <h4 class="text-primary">{{ configuracao.horas_planejada_p3 }}h</h4>
                                <p class="text-muted mb-0">Planejada P3</p>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="text-center p-3 border rounded">
                                <i class="fas fa-moon fa-2x text-dark mb-2"></i>
                                <h4 class="text-primary">{{ configuracao.horas_planejada_p4 }}h</h4>
                                <p class="text-muted mb-0">Planejada P4</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Configurações de Intervalos -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header">
                    <h5 class="mb-0 text-primary">
                        <i class="fas fa-stopwatch me-2"></i>Configurações de Intervalos
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="text-center p-3 border rounded">
                                <i class="fas fa-clock fa-2x text-info mb-2"></i>
                                <h4 class="text-info">{{ configuracao.intervalo_turno_6h }}h</h4>
                                <p class="text-muted mb-0">Após Turno de 6h</p>
                                <small class="text-muted">Folga mínima necessária</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="text-center p-3 border rounded">
                                <i class="fas fa-clock fa-2x text-warning mb-2"></i>
                                <h4 class="text-warning">{{ configuracao.intervalo_turno_12h }}h</h4>
                                <p class="text-muted mb-0">Após Turno de 12h</p>
                                <small class="text-muted">Folga mínima necessária</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="text-center p-3 border rounded">
                                <i class="fas fa-clock fa-2x text-orange mb-2"></i>
                                <h4 class="text-orange">{{ configuracao.intervalo_turno_18h }}h</h4>
                                <p class="text-muted mb-0">Após Turno de 18h</p>
                                <small class="text-muted">Folga mínima necessária</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="text-center p-3 border rounded">
                                <i class="fas fa-clock fa-2x text-danger mb-2"></i>
                                <h4 class="text-danger">{{ configuracao.intervalo_turno_24h }}h</h4>
                                <p class="text-muted mb-0">Após Turno de 24h</p>
                                <small class="text-muted">Folga mínima necessária</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Flexibilização de Validações -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card {% if configuracao.permitir_flexibilizacao_validacoes %}border-warning{% else %}border-secondary{% endif %} shadow-sm">
                <div class="card-header {% if configuracao.permitir_flexibilizacao_validacoes %}bg-warning text-dark{% else %}bg-secondary text-white{% endif %}">
                    <h5 class="mb-0">
                        <i class="fas {% if configuracao.permitir_flexibilizacao_validacoes %}fa-unlock-alt{% else %}fa-lock{% endif %} me-2"></i>
                        Flexibilização de Validações
                    </h5>
                </div>
                <div class="card-body">
                    {% if configuracao.permitir_flexibilizacao_validacoes %}
                        <div class="alert alert-warning mb-0">
                            <h6 class="alert-heading">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                Status: <strong class="text-danger">ATIVADA</strong>
                            </h6>
                            <p class="mb-2"><strong>As validações automáticas estão sendo ignoradas.</strong></p>
                            <p class="mb-0">Militares podem ser adicionados em planejadas mesmo que não atendam:</p>
                            <ul class="mb-0 mt-2">
                                <li>Qualificações por tipo de planejada (P1, P2, P3, P4)</li>
                                <li>Intervalos mínimos após turnos de serviço</li>
                                <li>Limites mensais de planejadas</li>
                                <li>Conflitos de horário com outras planejadas</li>
                            </ul>
                        </div>
                    {% else %}
                        <div class="alert alert-secondary mb-0">
                            <h6 class="alert-heading">
                                <i class="fas fa-lock me-2"></i>
                                Status: <strong>DESATIVADA</strong>
                            </h6>
                            <p class="mb-0">Todas as validações automáticas do sistema estão sendo aplicadas normalmente.</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Observações -->
    {% if configuracao.observacoes %}
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header">
                    <h5 class="mb-0 text-primary">
                        <i class="fas fa-sticky-note me-2"></i>Observações
                    </h5>
                </div>
                <div class="card-body">
                    <p class="mb-0">{{ configuracao.observacoes|linebreaks }}</p>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Ações -->
    <div class="row">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex gap-2">
                        <a href="{% url 'militares:configuracao_planejadas_edit' configuracao.id %}" class="btn btn-warning">
                            <i class="fas fa-edit me-2"></i>Editar Configuração
                        </a>
                        {% if not configuracao.ativo %}
                            <form method="post" action="{% url 'militares:configuracao_planejadas_activate' configuracao.id %}" class="d-inline">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-success" onclick="return confirm('Deseja ativar esta configuração?')">
                                    <i class="fas fa-play me-2"></i>Ativar Configuração
                                </button>
                            </form>
                        {% endif %}
                        <a href="{% url 'militares:configuracao_planejadas_list' %}" class="btn btn-outline-secondary">
                            <i class="fas fa-list me-2"></i>Ver Todas as Configurações
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
