{% extends 'base.html' %}
{% block content %}
<div class="container py-4">
  <div class="row">
    <div class="col-lg-10 mx-auto">
      <div class="card">
        <div class="card-header bg-light">
          <h5 class="mb-0"><i class="fas fa-info-circle me-2"></i>Detalhes da Revisão de Prova</h5>
        </div>
        <div class="card-body">
          <div class="row mb-3">
            <div class="col-md-6">
              <div><strong>Aluno:</strong> {{ pedido.aluno }}</div>
              <div><strong>Disciplina:</strong> {{ pedido.nota_avaliacao.avaliacao.disciplina.nome }}</div>
              <div><strong>Avaliação:</strong> {{ pedido.nota_avaliacao.avaliacao.nome }}</div>
              <div><strong>Nota atual:</strong> {{ pedido.nota_avaliacao.nota }}</div>
            </div>
            <div class="col-md-6">
              <div><strong>Status:</strong> <span class="badge bg-info">{{ pedido.get_status_display }}</span></div>
              <div><strong>Etapa:</strong> {{ pedido.get_etapa_display }}</div>
              <div><strong>Solicitado em:</strong> {{ pedido.data_solicitacao|date:"d/m/Y H:i" }}</div>
            </div>
          </div>
          {% if pedido.fundamentacao %}
          <div class="mb-3">
            <h6>Fundamentação</h6>
            <div class="border rounded p-3">{{ pedido.fundamentacao|safe }}</div>
          </div>
          {% endif %}
          {% if pedido.itens_solicitados %}
          <div class="mb-3">
            <h6>Itens solicitados</h6>
            <div class="border rounded p-3">{{ pedido.itens_solicitados|safe }}</div>
          </div>
          {% endif %}
          {% if pedido.despacho_envio_instrutor_texto %}
          <div class="mb-3">
            <h6>Despacho ao Instrutor</h6>
            <div class="border rounded p-3">{{ pedido.despacho_envio_instrutor_texto|safe }}</div>
            <div class="text-muted mt-1">{{ pedido.despacho_envio_instrutor_por.username|default:"" }}{% if pedido.despacho_envio_instrutor_data %} - {{ pedido.despacho_envio_instrutor_data|date:"d/m/Y H:i" }}{% endif %}</div>
          </div>
          {% endif %}
          {% if pedido.parecer_instrutor_texto %}
          <div class="mb-3">
            <h6>Parecer do Instrutor</h6>
            <div class="border rounded p-3">{{ pedido.parecer_instrutor_texto|safe }}</div>
            {% if pedido.nova_nota_instrutor %}
            <div class="mt-2"><strong>Nova nota proposta:</strong> {{ pedido.nova_nota_instrutor }}</div>
            {% endif %}
          </div>
          {% endif %}
          {% if pedido.parecer_final_texto %}
          <div class="mb-3">
            <h6>Parecer Final (Comissão)</h6>
            <div class="border rounded p-3">{{ pedido.parecer_final_texto|safe }}</div>
            {% if pedido.nova_nota_final %}
            <div class="mt-2"><strong>Nova nota final:</strong> {{ pedido.nova_nota_final }}</div>
            {% endif %}
          </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
