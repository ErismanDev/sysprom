<div class="modal-header bg-primary text-white">
    <h5 class="modal-title" id="detalhesMonitorModalLabel">
        <i class="fas fa-chalkboard-teacher me-2"></i>
        Detalhes do Monitor
    </h5>
    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
</div>
<div class="modal-body" style="max-height: 80vh; overflow-y: auto;">
    <!-- Foto e Identificação -->
                <div class="card mb-3">
                    <div class="card-header bg-primary text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-user-circle me-2"></i>
                            Foto e Identificação
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="row align-items-center">
                            <div class="col-md-2 text-center">
                                {% if monitor.tipo_monitor == 'BOMBEIRO' and monitor.militar and monitor.militar.foto %}
                                    <img src="{{ monitor.militar.foto.url }}" alt="Foto do monitor" class="img-thumbnail rounded-circle" style="width: 120px; height: 120px; object-fit: cover;">
                                {% elif monitor.tipo_monitor == 'OUTRA_FORCA' and monitor.foto_outra_forca %}
                                    <img src="{{ monitor.foto_outra_forca.url }}" alt="Foto do monitor" class="img-thumbnail rounded-circle" style="width: 120px; height: 120px; object-fit: cover;">
                                {% elif monitor.foto %}
                                    <img src="{{ monitor.foto.url }}" alt="Foto do monitor" class="img-thumbnail rounded-circle" style="width: 120px; height: 120px; object-fit: cover;">
                                {% else %}
                                    <div class="bg-secondary rounded-circle d-flex align-items-center justify-content-center mx-auto" style="width: 120px; height: 120px;">
                                        <i class="fas fa-user text-white" style="font-size: 50px;"></i>
                                    </div>
                                {% endif %}
                            </div>
                            <div class="col-md-10">
                                <h4 class="mb-2">{{ monitor.get_nome_completo|default:"Monitor" }}</h4>
                                <p class="mb-2">
                                    {% if monitor.tipo_monitor == 'BOMBEIRO' %}
                                        <span class="badge bg-primary">Bombeiro Militar</span>
                                    {% elif monitor.tipo_monitor == 'OUTRA_FORCA' %}
                                        <span class="badge bg-info">Militar de Outra Força</span>
                                    {% elif monitor.tipo_monitor == 'CIVIL' %}
                                        <span class="badge bg-secondary">Civil</span>
                                    {% else %}
                                        <span class="badge bg-secondary">Monitor</span>
                                    {% endif %}
                                    {% if monitor.ativo %}
                                        <span class="badge bg-success ms-2">Ativo</span>
                                    {% else %}
                                        <span class="badge bg-secondary ms-2">Inativo</span>
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Informações do Bombeiro Militar -->
                {% if monitor.tipo_monitor == 'BOMBEIRO' and monitor.militar %}
                <div class="card mb-3">
                    <div class="card-header bg-primary text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-fire me-2"></i>
                            Informações do Bombeiro Militar
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <dl class="row mb-0">
                                    <dt class="col-sm-5">Militar:</dt>
                                    <dd class="col-sm-7">
                                        <strong>
                                            {% if monitor.militar.get_posto_graduacao_display %}
                                                {{ monitor.militar.get_posto_graduacao_display }} 
                                            {% endif %}
                                            {{ monitor.militar.nome_completo }}
                                        </strong>
                                    </dd>
                                    
                                    <dt class="col-sm-5">Matrícula:</dt>
                                    <dd class="col-sm-7">{{ monitor.militar.matricula|default:"Não informado" }}</dd>
                                    
                                    <dt class="col-sm-5">CPF:</dt>
                                    <dd class="col-sm-7">{{ monitor.militar.cpf|default:"Não informado" }}</dd>
                                    
                                    <dt class="col-sm-5">Posto/Graduação:</dt>
                                    <dd class="col-sm-7">
                                        {% if monitor.militar.get_posto_graduacao_display %}
                                            {{ monitor.militar.get_posto_graduacao_display }}
                                        {% else %}
                                            Não informado
                                        {% endif %}
                                    </dd>
                                    
                                    <dt class="col-sm-5">Quadro:</dt>
                                    <dd class="col-sm-7">
                                        {% if monitor.militar.get_quadro_display %}
                                            {{ monitor.militar.get_quadro_display }}
                                        {% else %}
                                            Não informado
                                        {% endif %}
                                    </dd>
                                    
                                    <dt class="col-sm-5">Situação:</dt>
                                    <dd class="col-sm-7">
                                        {% if monitor.militar.get_situacao_display %}
                                            {{ monitor.militar.get_situacao_display }}
                                        {% else %}
                                            Não informado
                                        {% endif %}
                                    </dd>
                                </dl>
                            </div>
                            <div class="col-md-6">
                                <h6 class="border-bottom pb-2 mb-3">
                                    <i class="fas fa-address-card me-2"></i>
                                    Contatos e Endereço
                                </h6>
                                <dl class="row mb-0">
                                    <dt class="col-sm-5">E-mail:</dt>
                                    <dd class="col-sm-7">
                                        {% if monitor.email_bombeiro %}
                                            {{ monitor.email_bombeiro }}
                                        {% else %}
                                            {{ monitor.militar.email|default:"Não informado" }}
                                        {% endif %}
                                    </dd>
                                    
                                    <dt class="col-sm-5">Telefone:</dt>
                                    <dd class="col-sm-7">
                                        {% if monitor.telefone_bombeiro %}
                                            {{ monitor.telefone_bombeiro }}
                                        {% else %}
                                            {{ monitor.militar.telefone|default:monitor.militar.celular|default:"Não informado" }}
                                        {% endif %}
                                    </dd>
                                    
                                    <dt class="col-sm-5">Endereço:</dt>
                                    <dd class="col-sm-7">
                                        {% if monitor.endereco_bombeiro %}
                                            {{ monitor.endereco_bombeiro }}
                                        {% else %}
                                            {{ monitor.militar.endereco|default:"Não informado" }}
                                        {% endif %}
                                    </dd>
                                    
                                    <dt class="col-sm-5">Cidade:</dt>
                                    <dd class="col-sm-7">
                                        {% if monitor.cidade_bombeiro %}
                                            {{ monitor.cidade_bombeiro }}
                                        {% else %}
                                            {{ monitor.militar.cidade|default:"Não informado" }}
                                        {% endif %}
                                    </dd>
                                    
                                    <dt class="col-sm-5">UF:</dt>
                                    <dd class="col-sm-7">
                                        {% if monitor.uf_bombeiro %}
                                            {{ monitor.get_uf_bombeiro_display }}
                                        {% elif monitor.militar.uf %}
                                            {{ monitor.militar.uf }}
                                        {% else %}
                                            Não informado
                                        {% endif %}
                                    </dd>
                                    
                                    <dt class="col-sm-5">CEP:</dt>
                                    <dd class="col-sm-7">
                                        {% if monitor.cep_bombeiro %}
                                            {{ monitor.cep_bombeiro }}
                                        {% else %}
                                            {{ monitor.militar.cep|default:"Não informado" }}
                                        {% endif %}
                                    </dd>
                                </dl>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Informações do Militar de Outra Força -->
                {% if monitor.tipo_monitor == 'OUTRA_FORCA' %}
                <div class="card mb-3">
                    <div class="card-header bg-info text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-shield-alt me-2"></i>
                            Informações do Militar de Outra Força
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <dl class="row mb-0">
                                    <dt class="col-sm-5">Nome Completo:</dt>
                                    <dd class="col-sm-7"><strong>{{ monitor.nome_outra_forca|default:"Não informado" }}</strong></dd>
                                    
                                    <dt class="col-sm-5">Posto/Graduação:</dt>
                                    <dd class="col-sm-7">
                                        {% if monitor.posto_outra_forca %}
                                            {{ monitor.get_posto_outra_forca_display }}
                                        {% else %}
                                            Não informado
                                        {% endif %}
                                    </dd>
                                    
                                    <dt class="col-sm-5">Força Armada/Polícia:</dt>
                                    <dd class="col-sm-7">
                                        {% if monitor.forca_armada %}
                                            {{ monitor.get_forca_armada_display }}
                                        {% else %}
                                            Não informado
                                        {% endif %}
                                    </dd>
                                    
                                    <dt class="col-sm-5">Matrícula/Identificação:</dt>
                                    <dd class="col-sm-7">{{ monitor.matricula_outra_forca|default:"Não informado" }}</dd>
                                    
                                    <dt class="col-sm-5">CPF:</dt>
                                    <dd class="col-sm-7">{{ monitor.cpf_outra_forca|default:"Não informado" }}</dd>
                                    
                                    <dt class="col-sm-5">Instituição/Órgão:</dt>
                                    <dd class="col-sm-7">{{ monitor.instituicao_outra_forca|default:"Não informado" }}</dd>
                                </dl>
                            </div>
                            <div class="col-md-6">
                                <dl class="row mb-0">
                                    <dt class="col-sm-5">E-mail:</dt>
                                    <dd class="col-sm-7">{{ monitor.email_outra_forca|default:"Não informado" }}</dd>
                                    
                                    <dt class="col-sm-5">Telefone:</dt>
                                    <dd class="col-sm-7">{{ monitor.telefone_outra_forca|default:"Não informado" }}</dd>
                                    
                                    <dt class="col-sm-5">Endereço:</dt>
                                    <dd class="col-sm-7">{{ monitor.endereco_outra_forca|default:"Não informado" }}</dd>
                                    
                                    <dt class="col-sm-5">Cidade:</dt>
                                    <dd class="col-sm-7">{{ monitor.cidade_outra_forca|default:"Não informado" }}</dd>
                                    
                                    <dt class="col-sm-5">UF:</dt>
                                    <dd class="col-sm-7">
                                        {% if monitor.uf_outra_forca %}
                                            {{ monitor.get_uf_outra_forca_display }}
                                        {% else %}
                                            Não informado
                                        {% endif %}
                                    </dd>
                                    
                                    <dt class="col-sm-5">CEP:</dt>
                                    <dd class="col-sm-7">{{ monitor.cep_outra_forca|default:"Não informado" }}</dd>
                                </dl>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Informações do Civil -->
                {% if monitor.tipo_monitor == 'CIVIL' %}
                <div class="card mb-3">
                    <div class="card-header bg-secondary text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-user me-2"></i>
                            Informações do Monitor Civil
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <dl class="row mb-0">
                                    <dt class="col-sm-5">Nome Completo:</dt>
                                    <dd class="col-sm-7"><strong>{{ monitor.nome_civil|default:"Não informado" }}</strong></dd>
                                    
                                    <dt class="col-sm-5">CPF:</dt>
                                    <dd class="col-sm-7">{{ monitor.cpf_civil|default:"Não informado" }}</dd>
                                    
                                    <dt class="col-sm-5">RG:</dt>
                                    <dd class="col-sm-7">{{ monitor.rg_civil|default:"Não informado" }}</dd>
                                    
                                    <dt class="col-sm-5">Data de Nascimento:</dt>
                                    <dd class="col-sm-7">
                                        {% if monitor.data_nascimento_civil %}
                                            {{ monitor.data_nascimento_civil|date:"d/m/Y" }}
                                        {% else %}
                                            Não informado
                                        {% endif %}
                                    </dd>
                                    
                                    <dt class="col-sm-5">Formação Acadêmica:</dt>
                                    <dd class="col-sm-7">{{ monitor.formacao_civil|default:"Não informado" }}</dd>
                                    
                                    <dt class="col-sm-5">Instituição de Ensino:</dt>
                                    <dd class="col-sm-7">{{ monitor.instituicao_civil|default:"Não informado" }}</dd>
                                </dl>
                            </div>
                            <div class="col-md-6">
                                <dl class="row mb-0">
                                    <dt class="col-sm-5">E-mail:</dt>
                                    <dd class="col-sm-7">{{ monitor.email_civil|default:"Não informado" }}</dd>
                                    
                                    <dt class="col-sm-5">Telefone:</dt>
                                    <dd class="col-sm-7">{{ monitor.telefone_civil|default:"Não informado" }}</dd>
                                    
                                    <dt class="col-sm-5">Endereço:</dt>
                                    <dd class="col-sm-7">{{ monitor.endereco_civil|default:"Não informado" }}</dd>
                                    
                                    <dt class="col-sm-5">Cidade:</dt>
                                    <dd class="col-sm-7">{{ monitor.cidade_civil|default:"Não informado" }}</dd>
                                    
                                    <dt class="col-sm-5">UF:</dt>
                                    <dd class="col-sm-7">
                                        {% if monitor.uf_civil %}
                                            {{ monitor.get_uf_civil_display }}
                                        {% else %}
                                            Não informado
                                        {% endif %}
                                    </dd>
                                    
                                    <dt class="col-sm-5">CEP:</dt>
                                    <dd class="col-sm-7">{{ monitor.cep_civil|default:"Não informado" }}</dd>
                                </dl>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Habilitações e Qualificações -->
                <div class="card mb-3">
                    <div class="card-header bg-success text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-certificate me-2"></i>
                            Habilitações e Qualificações
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <h6 class="border-bottom pb-2">
                                    <i class="fas fa-award me-2"></i>Habilitações
                                </h6>
                                <p class="text-muted mb-0">
                                    {% if monitor.habilitacoes %}
                                        {{ monitor.habilitacoes|linebreaks }}
                                    {% else %}
                                        <em>Nenhuma habilitação cadastrada.</em>
                                    {% endif %}
                                </p>
                            </div>
                            <div class="col-md-6 mb-3">
                                <h6 class="border-bottom pb-2">
                                    <i class="fas fa-star me-2"></i>Especialidades
                                </h6>
                                <p class="text-muted mb-0">
                                    {% if monitor.especialidades %}
                                        {{ monitor.especialidades|linebreaks }}
                                    {% else %}
                                        <em>Nenhuma especialidade cadastrada.</em>
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <h6 class="border-bottom pb-2">
                                    <i class="fas fa-briefcase me-2"></i>Experiência Profissional
                                </h6>
                                <p class="text-muted mb-0">
                                    {% if monitor.experiencia_profissional %}
                                        {{ monitor.experiencia_profissional|linebreaks }}
                                    {% else %}
                                        <em>Nenhuma experiência cadastrada.</em>
                                    {% endif %}
                                </p>
                            </div>
                            <div class="col-md-6 mb-3">
                                <h6 class="border-bottom pb-2">
                                    <i class="fas fa-graduation-cap me-2"></i>Cursos Complementares
                                </h6>
                                <p class="text-muted mb-0">
                                    {% if monitor.cursos_complementares %}
                                        {{ monitor.cursos_complementares|linebreaks }}
                                    {% else %}
                                        <em>Nenhum curso complementar cadastrado.</em>
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                        {% if monitor.observacoes %}
                        <div class="row">
                            <div class="col-md-12">
                                <h6 class="border-bottom pb-2">
                                    <i class="fas fa-sticky-note me-2"></i>Observações
                                </h6>
                                <p class="text-muted mb-0">{{ monitor.observacoes|linebreaks }}</p>
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </div>
                
                <!-- Documentos -->
                <div class="card mb-3">
                    <div class="card-header bg-warning text-dark">
                        <h6 class="mb-0">
                            <i class="fas fa-file-alt me-2"></i>
                            Documentos Anexados
                        </h6>
                    </div>
                    <div class="card-body">
                        {% if monitor.documentos.all %}
                            <div class="table-responsive">
                                <table class="table table-sm table-hover">
                                    <thead>
                                        <tr>
                                            <th>Tipo</th>
                                            <th>Título</th>
                                            <th>Data Upload</th>
                                            <th>Upload por</th>
                                            <th>Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for doc in monitor.documentos.all %}
                                        <tr>
                                            <td>
                                                <span class="badge bg-info">{{ doc.get_tipo_display }}</span>
                                            </td>
                                            <td>{{ doc.titulo }}</td>
                                            <td>{{ doc.data_upload|date:"d/m/Y H:i" }}</td>
                                            <td>{{ doc.upload_por.get_full_name|default:doc.upload_por.username }}</td>
                                            <td>
                                                <a href="{{ doc.arquivo.url }}" target="_blank" class="btn btn-sm btn-info" title="Visualizar">
                                                    <i class="fas fa-eye"></i>
                                                </a>
                                                <a href="{{ doc.arquivo.url }}" download class="btn btn-sm btn-primary" title="Download">
                                                    <i class="fas fa-download"></i>
                                                </a>
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        {% else %}
                            <p class="text-muted mb-0 text-center">
                                <i class="fas fa-file-alt me-2"></i>
                                Nenhum documento anexado.
                            </p>
                        {% endif %}
                    </div>
                </div>
                
                <!-- Turmas -->
                <div class="card mb-3">
                    <div class="card-header bg-primary text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-users me-2"></i>
                            Turmas ({{ turmas|length }})
                        </h6>
                    </div>
                    <div class="card-body">
                        {% if turmas %}
                            <div class="accordion" id="accordionTurmasMonitorModal">
                                {% for turma in turmas %}
                                <div class="accordion-item">
                                    <h2 class="accordion-header" id="headingModalMonitor{{ turma.pk }}">
                                        <button class="accordion-button {% if not forloop.first %}collapsed{% endif %}" type="button" data-bs-toggle="collapse" data-bs-target="#collapseModalMonitor{{ turma.pk }}" aria-expanded="{% if forloop.first %}true{% else %}false{% endif %}" aria-controls="collapseModalMonitor{{ turma.pk }}">
                                            <strong>{{ turma.identificacao }}</strong> - {{ turma.curso.nome }} 
                                            <span class="badge bg-info ms-2">{{ turma.disciplinas_monitor.count }} Disciplina(s)</span>
                                            {% if turma.ativa %}
                                                <span class="badge bg-success ms-2">Ativa</span>
                                            {% else %}
                                                <span class="badge bg-secondary ms-2">Inativa</span>
                                            {% endif %}
                                        </button>
                                    </h2>
                                    <div id="collapseModalMonitor{{ turma.pk }}" class="accordion-collapse collapse {% if forloop.first %}show{% endif %}" aria-labelledby="headingModalMonitor{{ turma.pk }}" data-bs-parent="#accordionTurmasMonitorModal">
                                        <div class="accordion-body">
                                            <dl class="row mb-2" style="font-size: 0.85rem;">
                                                <dt class="col-sm-4">Curso:</dt>
                                                <dd class="col-sm-8">
                                                    <strong>{{ turma.curso.nome }}</strong>
                                                    {% if turma.curso.codigo %}
                                                        <br><small class="text-muted">Código: {{ turma.curso.codigo }}</small>
                                                    {% endif %}
                                                </dd>
                                                
                                                <dt class="col-sm-4">Período:</dt>
                                                <dd class="col-sm-8">
                                                    {% if turma.data_inicio %}
                                                        <i class="fas fa-calendar-alt me-1"></i>
                                                        {{ turma.data_inicio|date:"d/m/Y" }}
                                                    {% endif %}
                                                    {% if turma.data_fim %}
                                                        até {{ turma.data_fim|date:"d/m/Y" }}
                                                    {% endif %}
                                                </dd>
                                                
                                                <dt class="col-sm-4">Status:</dt>
                                                <dd class="col-sm-8">
                                                    {% if turma.ativa %}
                                                        <span class="badge bg-success">Ativa</span>
                                                    {% else %}
                                                        <span class="badge bg-secondary">Inativa</span>
                                                    {% endif %}
                                                </dd>
                                                
                                                <dt class="col-sm-4">Disciplinas Monitoradas:</dt>
                                                <dd class="col-sm-8">
                                                    {% if turma.disciplinas_monitor %}
                                                        <div class="d-flex flex-wrap gap-1">
                                                            {% for disciplina in turma.disciplinas_monitor %}
                                                                <span class="badge bg-info" style="font-size: 0.75rem;">
                                                                    <a href="{% url 'militares:ensino_disciplina_detalhes' pk=disciplina.pk %}" class="text-white text-decoration-none">
                                                                        {{ disciplina.nome }}
                                                                    </a>
                                                                </span>
                                                            {% endfor %}
                                                        </div>
                                                        <small class="text-muted d-block mt-1">
                                                            Total: {{ turma.disciplinas_monitor.count }} disciplina(s) nesta turma
                                                        </small>
                                                    {% else %}
                                                        <span class="text-muted">Nenhuma disciplina monitorada nesta turma</span>
                                                    {% endif %}
                                                </dd>
                                            </dl>
                                            
                                            {% if turma.observacoes %}
                                            <div class="alert alert-light mb-0">
                                                <small><strong>Observações:</strong> {{ turma.observacoes|truncatewords:20 }}</small>
                                            </div>
                                            {% endif %}
                                            
                                            <div class="text-end mt-3">
                                                <a href="{% url 'militares:ensino_turma_detalhes' pk=turma.pk %}" class="btn btn-primary btn-sm" target="_blank">
                                                    <i class="fas fa-external-link-alt me-2"></i>
                                                    Ver Detalhes Completos da Turma
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        {% else %}
                            <p class="text-muted mb-0 text-center">
                                <i class="fas fa-info-circle me-2"></i>
                                Nenhuma turma vinculada.
                            </p>
                        {% endif %}
                    </div>
                </div>
                
                <!-- Informações do Sistema -->
                <div class="card mb-3">
                    <div class="card-header bg-dark text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-info-circle me-2"></i>
                            Informações do Sistema
                        </h6>
                    </div>
                    <div class="card-body">
                        <dl class="row mb-0">
                            <dt class="col-sm-4">Data de Criação:</dt>
                            <dd class="col-sm-8">{{ monitor.data_criacao|date:"d/m/Y H:i" }}</dd>
                            
                            <dt class="col-sm-4">Última Atualização:</dt>
                            <dd class="col-sm-8">{{ monitor.data_atualizacao|date:"d/m/Y H:i" }}</dd>
                        </dl>
                    </div>
                </div>
            </div>
</div>
<div class="modal-footer">
    {% if menu_permissions.ENSINO_EDITAR or user.is_superuser %}
    <a href="{% url 'militares:ensino_monitor_editar' pk=monitor.pk %}" class="btn btn-warning">
        <i class="fas fa-edit me-2"></i>
        Editar
    </a>
    {% endif %}
    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
        <i class="fas fa-times me-2"></i>
        Fechar
    </button>
</div>

